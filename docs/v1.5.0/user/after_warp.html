<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>After Warping Options &#8212; C-PAC 1.5.0 Beta documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.5.0 Beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex" />
    <link rel="search" title="Search" href="../search" />
    <link rel="top" title="C-PAC 1.5.0 Beta documentation" href="../index" />
    <link rel="up" title="Pre-Processing Steps" href="preprocessing" />
    <link rel="next" title="Computable Derivatives" href="derivatives" />
    <link rel="prev" title="Timeseries Extraction" href="tse" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="derivatives" title="Computable Derivatives"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tse" title="Timeseries Extraction"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.5.0 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >Welcome to C-PAC&#8217;s user guide!</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="preprocessing" accesskey="U">Pre-Processing Steps</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="after-warping-options">
<h1>After Warping Options<a class="headerlink" href="#after-warping-options" title="Permalink to this headline">¶</a></h1>
<div class="section" id="spatial-smoothing">
<h2>Spatial Smoothing<a class="headerlink" href="#spatial-smoothing" title="Permalink to this headline">¶</a></h2>
<p>The main goal of smoothing is to increase the signal-to-noise ratio of an image. This is done by removing high-frequency information (assumed to consist mostly of noise) while preserving signals on larger spatial scales (those which stretch across multiple voxels and are most likely to reflect neuronal activity). Smoothing can also help reduce the effect of anatomical variability when comparing activations between subjects (Poldrack et al., 2011). Additionally, smoothing with a Gaussian kernel (described below) will cause the distribution of signals found in an image to more closely match the assumptions of many statistical tests often used on fMRI data.</p>
<div class="section" id="computation-and-analysis-considerations">
<h3>Computation and Analysis Considerations<a class="headerlink" href="#computation-and-analysis-considerations" title="Permalink to this headline">¶</a></h3>
<p>Smoothing is accomplished by applying a Gaussian filter (also known as a kernel) to the original image. This results in the signal of each voxel being replaced by the weighted average of its neighbors (Ashby, 2011). It is the shape of the kernel that defines the weights applied during smoothing. As a Gaussian kernel is essentially a normal distribution, weight is always strongest at the voxel being smoothed and decreases with distance at a rate that depends on the width of the distribution. Wider distributions result in greater smoothing, as more distant voxels recieve higher weights than they would with a thinner kernel. Unlike in statistics, where the width of a distribution is described by the standard deviation, the shape of a smoothing kernel is usually described by the width of the distribution at half of its maximum value. This is known as the Full Width Half Maximum (FWHM). The figure below shows the smoothing effect of different FWHM values.</p>
<div class="figure">
<img alt="../_images/smoothing.png" src="../_images/smoothing.png" />
</div>
<p><strong>Note:</strong> In C-PAC, smoothing is applied after calculating individual-level analyses (except for VMHC, for which smoothing is applied prior to calculation). This preserves the structure of the data as much as possible prior to statistical analysis.</p>
</div>
<div class="section" id="applications-and-guidelines">
<h3>Applications and Guidelines<a class="headerlink" href="#applications-and-guidelines" title="Permalink to this headline">¶</a></h3>
<p>The amount of smoothing applied should be the minimum necessary to achive the desired result. As a general rule, a FWHM of twice the voxel dimension is a good starting point (Poldrack et al., 2011). That being said, different situations will require adjustment of this value. In particular, the FWHM should never be larger than the smallest activation pattern you are interested in detecting; any larger value may result in signal loss, either by smoothing away very small signals, or smoothing two independent signals into one (Ashby, 2011).</p>
<p>Care must be taken when utilizing methods such as Regional Homogeneity (ReHo) and Multi-voxel Pattern Analysis (MVPA) which are sensitive to the activation of individual voxels, as smoothing prior to analysis may bias results by introducing artificial spatial correlation. In these cases, if smoothing is desired, such as in order to correct for multiple comparisons using Gaussian Random Field Theory, it must be applied after the fact.</p>
</div>
</div>
<div class="section" id="z-scored-derivatives">
<h2>Z-Scored Derivatives<a class="headerlink" href="#z-scored-derivatives" title="Permalink to this headline">¶</a></h2>
<p>C-PAC can take all of the outputs it produces and standardize their values as z-scores.</p>
<div class="section" id="configuring-c-pac-to-run-after-warping-steps">
<h3>Configuring C-PAC to Run After-Warping Steps<a class="headerlink" href="#configuring-c-pac-to-run-after-warping-steps" title="Permalink to this headline">¶</a></h3>
<div class="figure">
<img alt="../_images/after_warp_gui.png" src="../_images/after_warp_gui.png" />
</div>
<ol class="arabic simple">
<li><strong>Smoothing / Z-Scoring:</strong> Smooth the derivative outputs. On - Run smoothing and output only the smoothed outputs. On/Off - Run smoothing and output both the smoothed and non-smoothed outputs. Off - Don&#8217;t run smoothing.</li>
<li><strong>Smoothing Kernel FWHM (in mm) [integer/decimal]:</strong> Full Width at Half Maximum of the Gaussian kernel used during spatial smoothing. Can be a single value or multiple values separated by commas. Note that spatial smoothing is run as the last step in the individual-level analysis pipeline, such that all derivatives are output both smoothed and unsmoothed.</li>
<li><strong>Perfom smoothing before z-Scoring [On, Off]:</strong> Choose whether to smooth before or after z-scoring.</li>
<li><strong>Apply z-score Standardize to derivatives [On, Off]:</strong> z-score standardize the derivatives. This is required for group-level analysis. On - Run z-scoring and output only the z-scored outputs. On/Off - Run z-scoring and output both the z-scored and raw score versions of the outputs. Off - Don&#8217;t run z-scoring.</li>
</ol>
</div>
<div class="section" id="configuration-using-a-yaml-file">
<h3>Configuration Using a YAML File<a class="headerlink" href="#configuration-using-a-yaml-file" title="Permalink to this headline">¶</a></h3>
<p>The following key/value pairs must be defined in your <a class="reference internal" href="pipeline_config"><span class="doc">pipeline configuration YAML</span></a> for C-PAC to run the after warping options:</p>
<p>The box below contains an example of what these parameters might look like when defined in the pipeline configuration YAML:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">run_smoothing</span> <span class="p">:</span>  <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fwhm</span> <span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="n">smoothing_order</span> <span class="p">:</span>  <span class="p">[</span><span class="s1">&#39;Before&#39;</span><span class="p">]</span>
<span class="n">runZScoring</span> <span class="p">:</span>  <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="external-resources">
<h2>External Resources<a class="headerlink" href="#external-resources" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://mindhive.mit.edu/node/112">Smoothing FAQ - MIT Mindhive</a></li>
<li><a class="reference external" href="http://imaging.mrc-cbu.cam.ac.uk/imaging/ProcessingSmoothing">Smoothing - CBU Imaging Wiki</a></li>
</ul>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Ashby, F.G., (2011). Preprocessing. Statistical Analysis of MRI Data. Cambridge, MA: MIT Press.</p>
<p>Poldrack, R. A., Mumford, J., &amp; Nichols, T. (2011). Preprocessing fMRI data. In Handbook of Functional MRI Data Analysis. Cambridge: Cambridge University Press.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index">
              <img class="logo" src="../_static/cpac_logo_vertical.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index">Table Of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index#latest-release-c-pac-v1-5-0-oct-9-2019">Latest Release: C-PAC v1.5.0 (Oct 9, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#the-c-pac-mission">The C-PAC Mission</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#the-c-pac-team">The C-PAC Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#funding-acknowledgements">Funding Acknowledgements</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index#user-guide-index">User Guide Index</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="quick">1. C-PAC Quickstart</a></li>
<li class="toctree-l3"><a class="reference internal" href="subject_list_config">2. Specify Your Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline_config">3. Select Your Pipeline</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="preprocessing">4. Pre-Process Your Data</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="anat">Anatomical Preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="func">Functional Preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="nuisance">Nuisance Corrections</a></li>
<li class="toctree-l4"><a class="reference internal" href="aroma_ica">ICA Denoising</a></li>
<li class="toctree-l4"><a class="reference internal" href="tse">Timeseries Extraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="tse#configuring-roi-time-series-extraction">Configuring ROI Time Series Extraction</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">After Warp Settings</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#spatial-smoothing">Spatial Smoothing</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#computation-and-analysis-considerations">Computation and Analysis Considerations</a></li>
<li class="toctree-l6"><a class="reference internal" href="#applications-and-guidelines">Applications and Guidelines</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#z-scored-derivatives">Z-Scored Derivatives</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#configuring-c-pac-to-run-after-warping-steps">Configuring C-PAC to Run After-Warping Steps</a></li>
<li class="toctree-l6"><a class="reference internal" href="#configuration-using-a-yaml-file">Configuration Using a YAML File</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#external-resources">External Resources</a></li>
<li class="toctree-l5"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="derivatives">5. Compute Derivatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="running">6. All Run Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="group_analysis">7. Run Group Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="output_dir">8. Check Your Outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="help">9. Troubleshoot</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnotes">10. Release Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="appendix">Appendix</a></li>
<li class="toctree-l3"><a class="reference internal" href="appendix#benchmark-package">Benchmark Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index">Welcome to CPAC&#8217;s developer documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index#indices-and-tables">Indices and tables</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="derivatives" title="Computable Derivatives"
             >next</a> |</li>
        <li class="right" >
          <a href="tse" title="Timeseries Extraction"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.5.0 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >Welcome to C-PAC&#8217;s user guide!</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="preprocessing" >Pre-Processing Steps</a> &#187;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, C-PAC Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19224662-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-19224662-10');
    </script>
    <script defer src="https://fcp-indi.github.io/scripts/versionList.js"></script>

  </body>
</html>