
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Longitudinal Preprocessing &#8212; C-PAC 1.8.4.dev Beta documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex" />
    <link rel="search" title="Search" href="../search" />
    <link rel="next" title="ICA-AROMA (Independent Component Analysis - Automatic Removal of Motion Artifacts)" href="aroma_ica" />
    <link rel="prev" title="Pre-Processing Steps" href="preprocessing" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="aroma_ica" title="ICA-AROMA (Independent Component Analysis - Automatic Removal of Motion Artifacts)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="preprocessing" title="Pre-Processing Steps"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.4.dev Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="preprocessing" accesskey="U">Pre-Processing Steps</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Longitudinal Preprocessing</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="longitudinal-preprocessing">
<h1>Longitudinal Preprocessing<a class="headerlink" href="#longitudinal-preprocessing" title="Permalink to this headline">¶</a></h1>
<div class="flowchart-container"><object data="../_static/flowcharts/longitudinal.svg" type="image/svg+xml"></object></div><section id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p>Longitudinal preprocessing pipeline is designed to process longitudinal data with two or more sessions. Based on <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1053811912002765?via%3Dihub">Reuter et al. 2012</a>, all secions of subjects are first preprocessed independently and then a within-subject template is created by averaging all sessions of the subject. Subsequently the within-subject template is registered to standard space and all sections are then registered to the longitudinal template in standard space.</p>
<section id="configuring-cpac-to-run-longitudinal-preprocessing-pipeline">
<h3>Configuring CPAC to Run Longitudinal Preprocessing Pipeline<a class="headerlink" href="#configuring-cpac-to-run-longitudinal-preprocessing-pipeline" title="Permalink to this headline">¶</a></h3>
<figure class="align-default">
<img alt="../_images/longitudinal.png" src="../_images/longitudinal.png" />
</figure>
<ol class="arabic simple">
<li><p><strong>Longitudinal - [On, Off]:</strong>  Run longitudinal preprocessing pipeline or not. Default is Off.</p></li>
<li><p><strong>Average Method - [string]:</strong> Method to average longitudinal template. Default is median.</p></li>
<li><p><strong>DOF - [integer]:</strong>  Transform degree of freedom in flirt. Default is 12.</p></li>
<li><p><strong>Interpolation - [string]:</strong> Interpolation in flirt. Default is trilinear.</p></li>
<li><p><strong>Cost Function - [string]:</strong> Cost function in flirt. Default is corratio.</p></li>
<li><p><strong>Thread Pool - [integer]:</strong>  Number of threads in a thread pool. More threads can speed up the longitudinal template creation process. Default is 2.</p></li>
<li><p><strong>Convergence Threshold - [integer]:</strong> Convergence threshold of longitudinal template. Default is -1, which uses numpy.finfo(np.float64).eps.</p></li>
</ol>
</section>
<section id="configuration-without-the-gui">
<h3>Configuration Without the GUI<a class="headerlink" href="#configuration-without-the-gui" title="Permalink to this headline">¶</a></h3>
<p>The following nested key/value pairs will be set to these defaults if not defined in your <a class="reference internal" href="pipelines/pipeline_config"><span class="doc">pipeline configuration YAML</span></a>.</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">longitudinal_template_generation</span><span class="p">:</span><span class="w"></span>

<span class="w">  </span><span class="c1"># If you have multiple T1w&#39;s, you can generate your own run-specific custom</span><span class="w"></span>
<span class="w">  </span><span class="c1"># T1w template to serve as an intermediate to the standard template for</span><span class="w"></span>
<span class="w">  </span><span class="c1"># anatomical registration.</span><span class="w"></span>

<span class="w">  </span><span class="c1"># This runs before the main pipeline as it requires multiple T1w sessions</span><span class="w"></span>
<span class="w">  </span><span class="c1"># at once.</span><span class="w"></span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Off</span><span class="w"></span>

<span class="w">  </span><span class="c1"># Freesurfer longitudinal template algorithm using FSL FLIRT</span><span class="w"></span>
<span class="w">  </span><span class="c1"># Method to average the dataset at each iteration of the template creation</span><span class="w"></span>
<span class="w">  </span><span class="c1"># Options: median, mean or std</span><span class="w"></span>
<span class="w">  </span><span class="nt">average_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">median</span><span class="w"></span>

<span class="w">  </span><span class="c1"># Degree of freedom for FLIRT in the template creation</span><span class="w"></span>
<span class="w">  </span><span class="c1"># Options: 12 (affine), 9 (traditional), 7 (global rescale) or 6 (rigid body)</span><span class="w"></span>
<span class="w">  </span><span class="nt">dof</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12</span><span class="w"></span>

<span class="w">  </span><span class="c1"># Interpolation parameter for FLIRT in the template creation</span><span class="w"></span>
<span class="w">  </span><span class="c1"># Options: trilinear, nearestneighbour, sinc or spline</span><span class="w"></span>
<span class="w">  </span><span class="nt">interp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trilinear</span><span class="w"></span>

<span class="w">  </span><span class="c1"># Cost function for FLIRT in the template creation</span><span class="w"></span>
<span class="w">  </span><span class="c1"># Options: corratio, mutualinfo, normmi, normcorr, leastsq, labeldiff or bbr</span><span class="w"></span>
<span class="w">  </span><span class="nt">cost</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">corratio</span><span class="w"></span>

<span class="w">  </span><span class="c1"># Number of threads used for one run of the template generation algorithm</span><span class="w"></span>
<span class="w">  </span><span class="nt">thread_pool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"></span>

<span class="w">  </span><span class="c1"># Threshold of transformation distance to consider that the loop converged</span><span class="w"></span>
<span class="w">  </span><span class="c1"># (-1 means numpy.finfo(np.float64).eps and is the default)</span><span class="w"></span>
<span class="w">  </span><span class="nt">convergence_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-1</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Martin Reuter, Nicholas J.Schmansky, H. Diana Rosas, Bruce Fischl. <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1053811912002765?via%3Dihub">Within-subject template estimation for unbiased longitudinal image analysis.</a> Neuroimage. 2012 July 16; 61(4): 1402–1418. doi:10.1016/j.neuroimage.2012.02.084.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index">
              <img class="logo" src="../_static/cpac_logo_vertical.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="../index">Table of Contents</a></h3>
    <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="release_notes/v1.8.3">Latest Release: Version 1.8.3 Beta (Feb 11, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick">1. C-PAC Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="subject_list_config">2. Specify Your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipelines/pipeline_config">3. Select Your Pipeline</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="preprocessing">4. Pre-Process Your Data</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="anat">Anatomical Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="func">Functional Preprocessing</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Longitudinal Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="nuisance">Nuisance Corrections</a></li>
<li class="toctree-l3"><a class="reference internal" href="aroma_ica">ICA Denoising</a></li>
<li class="toctree-l3"><a class="reference internal" href="tse">Timeseries Extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tse#configuring-roi-time-series-extraction">Configuring ROI Time Series Extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="after_warp">After Warp Settings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="derivatives">5. Compute Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="running">6. All Run Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_analysis">7. Run Group Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="output_dir">8. Check Your Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="help">9. Troubleshoot</a></li>
<li class="toctree-l2"><a class="reference internal" href="rnotes">10. Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix">Appendix</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix#benchmark-package">Benchmark Package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index">Developer Documentation</a></li>
</ul>

  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="aroma_ica" title="ICA-AROMA (Independent Component Analysis - Automatic Removal of Motion Artifacts)"
             >next</a> |</li>
        <li class="right" >
          <a href="preprocessing" title="Pre-Processing Steps"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.4.dev Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="preprocessing" >Pre-Processing Steps</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Longitudinal Preprocessing</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, C-PAC Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19224662-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-19224662-10');
    </script>
    <script defer src="https://fcp-indi.github.io/scripts/versionList.js"></script>

  </body>
</html>