
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Inter-subject Correlation (ISC) &amp; Inter-subject Functional Correlation (ISFC) &#8212; C-PAC 1.8.4 Beta documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex" />
    <link rel="search" title="Search" href="../search" />
    <link rel="next" title="Quasi-Periodic Patterns (QPP)" href="group_qpp" />
    <link rel="prev" title="Multivariate Distance Matrix Regression (MDMR)" href="group_mdmr" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="group_qpp" title="Quasi-Periodic Patterns (QPP)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="group_mdmr" title="Multivariate Distance Matrix Regression (MDMR)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.4 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="group_analysis" accesskey="U">Group-Level Analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Inter-subject Correlation (ISC) &amp; Inter-subject Functional Correlation (ISFC)</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="inter-subject-correlation-isc-inter-subject-functional-correlation-isfc">
<h1>Inter-subject Correlation (ISC) &amp; Inter-subject Functional Correlation (ISFC)<a class="headerlink" href="#inter-subject-correlation-isc-inter-subject-functional-correlation-isfc" title="Permalink to this headline">¶</a></h1>
<section id="introduction-background">
<h2>Introduction &amp; Background<a class="headerlink" href="#introduction-background" title="Permalink to this headline">¶</a></h2>
<p>Inter-Subject Correlation (ISC) analyses is an increasingly popular approach to isolating stimulus-induced correlations from spontaneous intrinsic activity and non-neuronal signals. ISC quantifies the consistency of stimulus-driven responses among individuals at each region (i.e., voxel, parcel or network) in the brain. For each subject, the correlation of the timeseries at a given region is correlated with the average timeseries for the group. The methodology is particularly useful for the analysis of naturalistic viewing data (e.g., movie fMRI), but is broadly applicable to a range stimulus designs. Inter-Subject Functional Connectivity (Simony et al. 2016) is a novel extension of ISC that characterizes correlations between (a) response time courses for one seed region in one subject, and (b) the response time courses in all voxels of all other subjects.</p>
<p>The implementation provided in C-PAC is adapted from that openly shared by BrainIAK (<a class="reference external" href="http://brainiak.org">http://brainiak.org</a>).</p>
</section>
<section id="definition">
<h2>Definition<a class="headerlink" href="#definition" title="Permalink to this headline">¶</a></h2>
<p>The ISC method, for each region, computes the correlation of each subject’s timecourse with the mean of all other subjects’ timecourses. The result is averaged across subjects. A null-distribution is computed using phase randomization, to compute a p-value for each region.</p>
<p>The ISFC method computes the correlation between the timeseries of each region in each subject with the average of all other subjects’ timecourses in all regions. The result is averaged across subjects. A null-distribution is computed using phase randomization, to compute a p-value for each region-to-region correlation.</p>
<figure class="align-default">
<img alt="../_images/isc_isfc.jpg" src="../_images/isc_isfc.jpg" />
</figure>
<p>Image from Simony et al. <cite>Dynamic reconfiguration of the default mode network during narrative comprehension</cite>. Nat Commun 7 (2016)</p>
</section>
<section id="computation-considerations">
<h2>Computation Considerations<a class="headerlink" href="#computation-considerations" title="Permalink to this headline">¶</a></h2>
<p>In order to compute ISC and ISFC, for each region or voxel, it computes the group average on a region or every other regions and correlate it with a subject region. Thus, the computation on voxel level may take from hours to days, depending on the number of participants and the resolution of the images. We provide a voxel filter, to reduce the number of voxels to compute the significance. It removes the voxels on the tails of the correlation distribution, based on an informed standard deviation.</p>
<section id="example-analysis-healthy-brain-network-and-age">
<h3>Example Analysis: Healthy Brain Network and Age<a class="headerlink" href="#example-analysis-healthy-brain-network-and-age" title="Permalink to this headline">¶</a></h3>
<p>We computed the ISC for 200 participants from the Healthy Brain Network (HBN), using the functional data of a passive stimuli paradigm in which the participants view a short video clip called The Present (3.47 min). In order to analyse it, we use two parcellations: Yeo’s and Craddock’s. We model the ISC of each region with the with the participant age using linear regression.</p>
<figure class="align-default">
<img alt="../_images/isc-hbn-yeo.png" src="../_images/isc-hbn-yeo.png" />
</figure>
<figure class="align-default">
<img alt="../_images/isc-hbn-cc.png" src="../_images/isc-hbn-cc.png" />
</figure>
</section>
<section id="replication-of-simony-et-al-study-on-narrative-comprehension">
<h3>Replication of Simony et al. study on narrative comprehension<a class="headerlink" href="#replication-of-simony-et-al-study-on-narrative-comprehension" title="Permalink to this headline">¶</a></h3>
<p>To characterize stimulus-induced Default Mode Network correlation patterns, Simony et al. (2016) collected BOLD responses during narrative-driven and resting state conditions. Subjects listened to a real-life story (intact task), as well as to word scramble and paragraph scramble versions of the story.</p>
<p>By isolating the stimulus-driven responses for each task, Simony et al. demonstrated a robust activation alignment of the Default Mode Network nodes across subjects, corresponding to the processing of a coherent narrative.</p>
<p>The following images correspond to the correlation of the posterior cingulate cortex and the entire brain using the ISFC method. The correlations are stronger according to the coherence of the story.</p>
<p>The replication using C-PAC was carried out using the data from the original study, which was made available by the Princeton Neuroscience Institute at:
<a class="reference external" href="https://dataspace.princeton.edu/jspui/handle/88435/dsp015d86p269k">https://dataspace.princeton.edu/jspui/handle/88435/dsp015d86p269k</a></p>
<figure class="align-default">
<img alt="../_images/isfc-simony-1.png" src="../_images/isfc-simony-1.png" />
</figure>
<figure class="align-default">
<img alt="../_images/isfc-simony-2.png" src="../_images/isfc-simony-2.png" />
</figure>
</section>
</section>
<section id="configuring-isc-isfc">
<h2>Configuring ISC/ISFC<a class="headerlink" href="#configuring-isc-isfc" title="Permalink to this headline">¶</a></h2>
<section id="configuration-using-a-yaml-file">
<h3>Configuration Using a YAML File<a class="headerlink" href="#configuration-using-a-yaml-file" title="Permalink to this headline">¶</a></h3>
<p>To configure ISC/ISFC options within a YAML file, add the following lines to your pipeline config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">runISC</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">runISFC</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">isc_permutations</span><span class="p">:</span> <span class="mi">1000</span>
<span class="n">isc_level_roi</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">isc_level_voxel</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">isc_level_voxel_std_filter</span><span class="p">:</span> <span class="mf">1.5</span>
</pre></div>
</div>
</section>
<section id="outputs">
<h3>Outputs<a class="headerlink" href="#outputs" title="Permalink to this headline">¶</a></h3>
<p>The ISC analysis outputs three files:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">correlations.csv</span></code> or <code class="code docutils literal notranslate"><span class="pre">correlations.nii.gz</span></code>: inter-subject correlations for each subject. The CSV file is generated for the ROI analysis. Each row is a subject, and each column is one of the regions. For the voxel analysis, it generates a 4-D Nifti file, in which the fourth dimension is the subject.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">significance.csv</span></code> or <code class="code docutils literal notranslate"><span class="pre">significance.nii.gz</span></code>: p-values of the permutation test for each subject.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">subject_ids.txt</span></code>: in order to keep track which index is for each subject, we provide the ordered subject id.</p></li>
</ul>
<p>The ISFC analysis outputs three files:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">correlations.npy</span></code>: numpy array with the inter-subject correlations for each subject, with shape <code class="code docutils literal notranslate"><span class="pre">(subject,</span> <span class="pre">region,</span> <span class="pre">region)</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">significance.npy</span></code>: numpy array with the p-values of the permutation test for each subject, with shape <code class="code docutils literal notranslate"><span class="pre">(subject,</span> <span class="pre">region,</span> <span class="pre">region)</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">subject_ids.txt</span></code>: in order to keep track which index is for each subject, we provide the ordered subject id.</p></li>
</ul>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Hasson, U., Nir, Y., Levy, I., Fuhrmann, G. &amp; Malach, R.
<cite>Intersubject synchronization of cortical activity during natural vision</cite>. Science 303, 1634–1640 (2004).</p>
<p>Simony E, Honey CJ, Chen J, Lositsky O, Yeshurun Y, Wiesel A, Hasson U
<cite>Dynamic reconfiguration of the default mode network during narrative comprehension</cite>. Nat Commun 7 (2016).</p>
<p>Kauppi, Jukka-Pekka, Iiro P. Jääskeläinen, Mikko Sams, and Jussi Tohka.
<cite>Inter-subject correlation of brain hemodynamic responses during watching a movie: localization in space and frequency</cite>. Frontiers in neuroinformatics 4 (2010).</p>
<p>Jääskeläinen, Iiro P., Katri Koskentalo, Marja H. Balk, Taina Autti, Jaakko Kauramäki, Cajus Pomren, and Mikko Sams.
<cite>Inter-subject synchronization of prefrontal cortex hemodynamic activity during natural viewing</cite>. The open neuroimaging journal 2 (2008).</p>
<p>Pajula, Juha, Jukka-Pekka Kauppi, and Jussi Tohka.
<cite>Inter-subject correlation in fMRI: method validation against stimulus-model based analysis</cite>. PloS one 7, no. 8 (2012).</p>
<p>Hasson U, Malach R, Heeger DJ.
<cite>Reliability of cortical activity during natural stimulation</cite>. Trends Cogn Sci 14:40-48 (2010).</p>
<p>Mukamel R, Gelbard H, Arieli A, Hasson U, Fried I, Malach R
<cite>Coupling between neuronal firing, field potentials, and FMRI in human auditory cortex</cite>. Science (2005).</p>
<p>Ben-Yakov A, Honey CJ, Lerner Y, Hasson U
<cite>Loss of reliable temporal structure in event-related averaging of naturalistic stimuli</cite>. NeuroImage 63:501-506 (2012).</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index">
              <img class="logo" src="../_static/cpac_logo_vertical.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index">Table of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="release_notes/v1.8.4">Latest Release: Version 1.8.4 Beta (Jun 28, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick">1. C-PAC Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="subject_list_config">2. Specify Your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipelines/pipeline_config">3. Select Your Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="preprocessing">4. Pre-Process Your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="derivatives">5. Compute Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="running">6. All Run Options</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="group_analysis">7. Run Group Analysis</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="group_fsl_feat">FSL FEAT &amp; Randomise</a></li>
<li class="toctree-l3"><a class="reference internal" href="group_pybasc">Bootstrapped Analysis of Stable Clusters (PyBASC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="group_mdmr">Multivariate Distance Matrix Regression (MDMR)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Inter-subject Correlation (ISC) &amp; Inter-subject Functional Correlation (ISFC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="group_qpp">Quasi-Periodic Patterns (QPP)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="output_dir">8. Check Your Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/index">9. Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="help">10. Troubleshoot</a></li>
<li class="toctree-l2"><a class="reference internal" href="rnotes">11. Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix">Appendix</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix#benchmark-package">Benchmark Package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license">License</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="group_qpp" title="Quasi-Periodic Patterns (QPP)"
             >next</a> |</li>
        <li class="right" >
          <a href="group_mdmr" title="Multivariate Distance Matrix Regression (MDMR)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.4 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="group_analysis" >Group-Level Analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Inter-subject Correlation (ISC) &amp; Inter-subject Functional Correlation (ISFC)</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2012‒2022, C-PAC Developers. C-PAC is licensed under LGPL-3.0-or-later.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.0.
    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19224662-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-19224662-10');
    </script>
    <script defer src="https://fcp-indi.github.io/scripts/versionList.js"></script>

  </body>
</html>