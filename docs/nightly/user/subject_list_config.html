
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Setting Up A Data Configuration File (Participant/Subject List) &#8212; C-PAC 1.8.5.dev Beta documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex" />
    <link rel="search" title="Search" href="../search" />
    <link rel="next" title="Setting Up A Pipeline Configuration" href="pipelines/pipeline_config" />
    <link rel="prev" title="C-PAC Quickstart" href="quick" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pipelines/pipeline_config" title="Setting Up A Pipeline Configuration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="quick" title="C-PAC Quickstart"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.5.dev Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" accesskey="U">User Documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Setting Up A Data Configuration File (Participant/Subject List)</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="setting-up-a-data-configuration-file-participant-subject-list">
<h1>Setting Up A Data Configuration File (Participant/Subject List)<a class="headerlink" href="#setting-up-a-data-configuration-file-participant-subject-list" title="Permalink to this headline">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p><strong>C-PAC’s Configuration YAML Files</strong></p>
<p>C-PAC requires at least one pipeline configuration file and one data configuration file (also known as the participant list/subject list) in order to run an analysis. These configuration files are in the YAML file format, which matches contents in a key: value relationship much like a dictionary. This section will focus on the data configuration file setup.</p>
<p><strong>The Data Configuration (Participant List)</strong></p>
<p>The data configuration file is essentially a list of file paths to anatomical and functional MRI scans keyed by their unique IDs, and listed with any additional information as necessary. This file can be generated by C-PAC through the terminal. This process is explained below.</p>
<p><strong>UPDATE (May 15, 2018): C-PAC v1.1.0 and Later</strong>
The data configuration file layout has changed significantly from older versions. Functional scan file paths, and scan parameter information (or scan parameter file paths) are now nested beneath the “func:” key. See the “Data Configuration File YAML Fields” section below for examples.</p>
<p>If you have already-existing data configuration files and wish to update these for the new version, you can simply use your already-existing data settings preset files to regenerate the data configuration files using C-PAC ≥v1.1.0. If you have any questions, please reach us on <a class="reference external" href="https://neurostars.org/tag/cpac">Neurostars</a>.</p>
</section>
<section id="from-terminal">
<h2>From Terminal<a class="headerlink" href="#from-terminal" title="Permalink to this headline">¶</a></h2>
<section id="create-data-settings-yml-template-file">
<h3>Create data_settings.yml template file<a class="headerlink" href="#create-data-settings-yml-template-file" title="Permalink to this headline">¶</a></h3>
<p>You can configure the settings explained below in the <strong>data settings</strong> YAML file, then use the C-PAC command-line interface to generate your <strong>data configuration</strong> file.</p>
<p>If you don’t already have a data settings YAML file, you can generate one in your current directory by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cpac</span> <span class="n">utils</span> <span class="n">data_config</span> <span class="n">new_settings_template</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">singularity</span> <span class="n">run</span> <span class="n">C</span><span class="o">-</span><span class="n">PAC_latest</span><span class="o">.</span><span class="n">sif</span> <span class="n">bids_dir</span> <span class="n">outputs_dir</span> <span class="n">cli</span> <span class="o">--</span> <span class="n">utils</span> <span class="n">data_config</span> <span class="n">new_settings_template</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>docker run -i --rm --user $(id -u):$(id -g) -v /path/to/data_config:/scratch -w=&quot;/scratch&quot; fcpindi/c-pac:latest bids_dir outputs_dir cli -- utils data_config new_settings_template
</pre></div>
</div>
<p>If running a container directly (either of the latter options rather than the first option, which is through <a class="reference internal" href="cpac"><span class="doc">cpac (Python package)</span></a>), <code class="docutils literal notranslate"><span class="pre">bids_dir</span></code> and <code class="docutils literal notranslate"><span class="pre">outputs_dir</span></code> are required but not used, so any non-null string will work for those positional arguments.</p>
<p>The Singularity command will create <code class="docutils literal notranslate"><span class="pre">data_settings.yml</span></code> in the current working directory you call the command from.</p>
<p>The Docker command requires a few more parameters than the Singularity command:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--user</span> <span class="pre">$(id</span> <span class="pre">-u)</span></code> is necessary so the generated files will be owned locally by the user running Docker rather than by <code class="docutils literal notranslate"><span class="pre">c-pac_user</span></code> (the default).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-v</span> <span class="pre">/path/to/data_config:/scratch</span></code> binds your local <code class="docutils literal notranslate"><span class="pre">data_config</span></code> directory to <code class="docutils literal notranslate"><span class="pre">/scratch</span></code> on the Docker image, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-w=&quot;/scratch&quot;</span></code> sets the current working directory on the Docker image to <code class="docutils literal notranslate"><span class="pre">/scratch</span></code>.</p></li>
</ul>
</section>
<section id="generate-configuration-files-for-individual-level-and-group-level-analyses">
<h3>Generate configuration files for individual-level and group-level analyses<a class="headerlink" href="#generate-configuration-files-for-individual-level-and-group-level-analyses" title="Permalink to this headline">¶</a></h3>
<p>Once you have a template, you can then configure the file as needed. You will need to use a text editor to fill in at least <code class="docutils literal notranslate"><span class="pre">dataFormat</span></code>, <code class="docutils literal notranslate"><span class="pre">bidsBaseDir</span></code> (if using BIDS data), <code class="docutils literal notranslate"><span class="pre">outputSubjectListLocation</span></code>, and <code class="docutils literal notranslate"><span class="pre">subjectListName</span></code> in your settings file before you build.</p>
<p>Once your <code class="docutils literal notranslate"><span class="pre">data_settings.yml</span></code> file is ready, you can generate your data configuration file by running the following commands, binding any directories in your <code class="docutils literal notranslate"><span class="pre">data_settings.yml</span></code> to the same locations in the container:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">singularity</span> <span class="n">run</span> \
<span class="o">-</span><span class="n">B</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">bids_dir</span> \
<span class="o">-</span><span class="n">B</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">outputs</span> \
<span class="o">-</span><span class="n">B</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="ow">in</span><span class="o">/</span><span class="n">data_settings</span><span class="o">/</span><span class="mi">1</span> \
<span class="o">-</span><span class="n">B</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="ow">in</span><span class="o">/</span><span class="n">data_settings</span><span class="o">/</span><span class="mi">2</span> \
<span class="n">C</span><span class="o">-</span><span class="n">PAC_latest</span><span class="o">.</span><span class="n">sif</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">bids_dir</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">outputs</span> <span class="n">cli</span> <span class="o">--</span> <span class="n">utils</span> \
<span class="n">data_config</span> <span class="n">build</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data_settings</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>docker run -i --rm --user $(id -u):$(id -g) \
-v /path/to/bids_dir:/path/to/bids_dir \
-v /path/to/outputs:/path/to/outputs \
-v /path/to/data/in/data_settings/1:/path/to/data/in/data_settings/1 \
-v /path/to/data/in/data_settings/2:/path/to/data/in/data_settings/2 \
-v /path/to/data_config:/scratch -w=&quot;/scratch&quot; \
fcpindi/c-pac:latest /path/to/bids_dir /path/to/outputs cli -- utils \
data_config build /path/to/data_settings.yml
</pre></div>
</div>
<p>Continue below for some example use cases.</p>
</section>
</section>
<section id="data-settings-yml-contents">
<h2>data_settings.yml contents<a class="headerlink" href="#data-settings-yml-contents" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p><strong>Data format - [BIDS, Custom]:</strong> Whether or not the data is organized in accordance with the BIDS specification. More details below.</p></li>
<li><p><strong>BIDS Base Directory - [path]:</strong> The base directory of the BIDS-organized data, if you are using BIDS.</p></li>
<li><p><strong>Anatomical File Path Template - [text]:</strong> If the data is NOT in BIDS format, you can provide a file path template describing the anatomical scans here. More details below.</p></li>
<li><p><strong>Functional File Path Template - [text]:</strong> If the data is NOT in BIDS format, you can provide a file path template describing the functional scans here. More details below.</p></li>
<li><p><strong>Save Config Files Here - [path]:</strong> The directory where you want the data configuration builder to save both the <strong>data settings</strong> file (these configured options) and the <strong>data configuration</strong> file (the list of input data to be provided to CPAC).</p></li>
<li><p><strong>Participant List Name - [text]:</strong> The name/label for your data configuration and data settings files.</p></li>
<li><p><strong>(Optional) Which Anatomical Scan? - [text]:</strong> Sometimes, there are multiple anatomical scans per participant in a dataset. To make life easier, you can tell the data configuration builder which anatomical scan to select for each participant by entering a sub-string here that can be found in the name or label of the anatomical scan you’d like to use for the run. Also, if you are using the Custom Anatomical File Path Template, you can enter a wildcard (*) in the path template in the anatomical scan file name, and the sub-string you enter here will determine which of the files returned by that wildcard is written into the data configuration.</p></li>
<li><p><strong>(Optional) AWS Credentials File - [path]:</strong> Required if downloading data from a non-public S3 bucket on Amazon Web Services (AWS). This usually takes the form of a CSV file.</p></li>
<li><p><strong>(Optional) Scan Parameters File - [path]:</strong>  Path to a CSV file specifying the slice time acquisition parameters for scans.  If set to ‘None’, these parameters will either be defined by the NifTI headers or by an explicit slice order specified in the pipeline configuration builder. Instructions for creating this CSV file can be found <a class="reference internal" href="func"><span class="doc">here</span></a>. <strong>Note:</strong> If your data is in BIDS format, the data configuration builder will read the scan parameters described in the data’s affiliated JSON file(s), if they exist, and a scan parameters CSV file is not required.</p></li>
<li><p><strong>(Optional) Brain Mask File Path Template - [text]:</strong> File Path Template for brain mask files. For anatomical skull-stripping. Note: use this for BIDS data directories as well, as the specification for anatomical brain masks is still subject to change. Place tags for the appropriate data directory levels with the tags {site}, {participant}, and {session}. Only {participant} is required. Example: /data/{site}/{participant}/{session}/{participant}_{session}_brain-mask.nii.gz</p></li>
<li><p><strong>(Optional) Field Map Phase File Path Template - [text]:</strong> If you are running field map-based distortion correction, AND your data is not in BIDS format, provide the file path template to your phase files here. If your data is in BIDS format, the data configuration builder will find these files automatically.</p></li>
<li><p><strong>(Optional) Field Map Magnitude File Path Template - [text]:</strong> If you are running field map-based distortion correction, AND your data is not in BIDS format, provide the file path template to your magnitude difference files here. If your data is in BIDS format, the data configuration builder will find these files automatically.</p></li>
<li><p><strong>(Optional) Include: Subjects - [text/path]:</strong> List the participant IDs to include, to have only those participants included in the list. Either enter it here (ex. “1001, 1002, 1007, ..”), or enter the file path of a text file containing each participant ID on its own line.</p></li>
<li><p><strong>(Optional) Exclude: Subjects - [text/path]:</strong> The same as above, except to exclude the participants you list here. Useful for when you only need a few dropped from the list of many.</p></li>
<li><p><strong>(Optional) Include: Sites - [text/path]:</strong> Which sites to include - can be a list or a text file, as described above.</p></li>
<li><p><strong>(Optional) Exclude: Sites - [text/path]:</strong> Which sites to exclude - can be a list or a text file, as described above.</p></li>
<li><p><strong>(Optional) Include: Sessions - [text/path]:</strong> Which sessions to include - can be a list or a text file, as described above.</p></li>
<li><p><strong>(Optional) Exclude: Sessions - [text/path]:</strong> Which sessions to exclude - can be a list or a text file, as described above.</p></li>
<li><p><strong>(Optional) Include: Series - [text/path]:</strong> Which series to include - can be a list or a text file, as described above.</p></li>
<li><p><strong>(Optional) Exclude: Series - [text/path]:</strong> Which series to exclude - can be a list or a text file, as described above.</p></li>
</ol>
<p>Continue below for some example use cases.</p>
</section>
<section id="data-bids-format">
<h2>Data: BIDS Format<a class="headerlink" href="#data-bids-format" title="Permalink to this headline">¶</a></h2>
<p>A full description of the BIDS data organization specification can be found at <a class="reference external" href="http://bids.neuroimaging.io/">bids.neuroimaging.io</a>.</p>
<p>This is the simplest option. As the data is in BIDS format, the C-PAC data configuration builder will know where to find all of the input files, the scan parameters (if available), site information, and field map files (if applicable). The inclusion and exclusion options for the different data levels (participant, site, etc.) work as usual.</p>
<p><strong>Using the cpac_data_config_setup.py script</strong></p>
<p>In the data settings file, populate these fields:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataFormat</span><span class="p">:</span>                  <span class="p">[</span><span class="s1">&#39;BIDS&#39;</span><span class="p">]</span>
<span class="n">bidsBaseDir</span><span class="p">:</span>                 <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">BIDS</span><span class="o">/</span><span class="n">directory</span>
<span class="n">outputSubjectListLocation</span><span class="p">:</span>   <span class="o">/</span><span class="n">save</span><span class="o">/</span><span class="n">configs</span><span class="o">/</span><span class="n">here</span>
<span class="n">subjectListName</span><span class="p">:</span>             <span class="n">data_config_name</span>
</pre></div>
</div>
<p>You can also fill in the AWS credentials file field, and the inclusion and exclusion fields, as needed.</p>
<p>Once your data settings file is ready, generate your data configuration file by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cpac</span> <span class="n">utils</span> <span class="n">data_config</span> <span class="n">build</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data_settings</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">singularity</span> <span class="n">run</span> <span class="n">C</span><span class="o">-</span><span class="n">PAC_latest</span><span class="o">.</span><span class="n">sif</span> <span class="n">bids_dir</span> <span class="n">outputs_dir</span> <span class="n">cli</span> <span class="o">--</span> <span class="n">utils</span> <span class="n">data_config</span> <span class="n">build</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data_settings</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>docker run -i --rm --user $(id -u) -v /path/to/data_config:/scratch -w=&quot;/scratch&quot; fcpindi/c-pac:latest bids_dir outputs_dir cli -- utils data_config build /path/to/data_settings.yml
</pre></div>
</div>
</section>
<section id="data-custom-layout">
<h2>Data: Custom Layout<a class="headerlink" href="#data-custom-layout" title="Permalink to this headline">¶</a></h2>
<p>The C-PAC Data Configuration builder can handle a wide range of different directory organization layouts, but can only do it seamlessly for you if all of your data is organized in that same layout. If you have input files arranged in different ways, simply generate two different data configuration files, and then manually add one to the end of the other, in a text editor.</p>
<p><strong>Using the C-PAC command-line interface (CLI)</strong></p>
<p>Your template paths should look something like this, for the corresponding directory layouts:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Actual</span> <span class="n">file</span><span class="p">:</span>     <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="mi">01</span><span class="o">/</span><span class="n">sub1003</span><span class="o">/</span><span class="n">session</span><span class="o">-</span><span class="n">A1</span><span class="o">/</span><span class="n">anat</span><span class="o">/</span><span class="n">mprage</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
<span class="n">Template</span> <span class="n">path</span><span class="p">:</span>   <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="p">{</span><span class="n">site</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">participant</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">session</span><span class="p">}</span><span class="o">/</span><span class="n">anat</span><span class="o">/</span><span class="n">mprage</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>

<span class="n">Actual</span> <span class="n">file</span><span class="p">:</span>     <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="mi">03</span><span class="o">/</span><span class="n">sub</span><span class="o">-</span><span class="mi">1005</span><span class="n">_session</span><span class="o">-</span><span class="n">B1</span><span class="o">/</span><span class="n">anat</span><span class="o">/</span><span class="n">anat</span><span class="o">.</span><span class="n">nii</span>
<span class="n">Template</span> <span class="n">path</span><span class="p">:</span>   <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="p">{</span><span class="n">site</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">participant</span><span class="p">}</span><span class="n">_</span><span class="p">{</span><span class="n">session</span><span class="p">}</span><span class="o">/</span><span class="n">anat</span><span class="o">/</span><span class="n">anat</span><span class="o">.</span><span class="n">nii</span>
</pre></div>
</div>
<p>Following the instructions for formatting your path templates given above, populate these fields in your data settings file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataFormat</span><span class="p">:</span>                  <span class="p">[</span><span class="s1">&#39;Custom&#39;</span><span class="p">]</span>
<span class="n">anatomicalTemplate</span><span class="p">:</span>          <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="p">{</span><span class="n">site</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">participant</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">series</span><span class="p">}</span><span class="o">/</span><span class="n">anat</span><span class="o">/</span><span class="n">mprage</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
<span class="n">functionalTemplate</span><span class="p">:</span>          <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="p">{</span><span class="n">site</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">participant</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">series</span><span class="p">}</span><span class="o">/</span><span class="n">func</span><span class="o">/</span><span class="p">{</span><span class="n">series</span><span class="p">}</span><span class="o">/</span><span class="n">bold</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
<span class="n">outputSubjectListLocation</span><span class="p">:</span>   <span class="o">/</span><span class="n">save</span><span class="o">/</span><span class="n">configs</span><span class="o">/</span><span class="n">here</span>
<span class="n">subjectListName</span><span class="p">:</span>             <span class="n">data_config_name</span>
</pre></div>
</div>
<p>You can also fill in the AWS credentials file field, and the inclusion and exclusion fields, as needed.</p>
<p>Once your data settings file is ready, generate your data configuration file by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cpac</span> <span class="n">utils</span> <span class="n">data_config</span> <span class="n">build</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data_settings</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">singularity</span> <span class="n">run</span> <span class="n">C</span><span class="o">-</span><span class="n">PAC_latest</span><span class="o">.</span><span class="n">sif</span> <span class="n">bids_dir</span> <span class="n">outputs_dir</span> <span class="n">cli</span> <span class="o">--</span> <span class="n">utils</span> <span class="n">data_config</span> <span class="n">build</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data_settings</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>docker run -i --rm --user $(id -u) -v /path/to/data_config:/scratch -w=&quot;/scratch&quot; fcpindi/c-pac:latest bids_dir outputs_dir cli -- utils data_config build /path/to/data_settings.yml
</pre></div>
</div>
</section>
<section id="custom-path-templates">
<h2>Custom Path Templates<a class="headerlink" href="#custom-path-templates" title="Permalink to this headline">¶</a></h2>
<p>Here are the file path templates used for the <a class="reference external" href="http://fcon_1000.projects.nitrc.org/fcpClassic/FcpTable.html">1000 Functional Connectomes</a> data release, as well as an illustration of the directory structure used for the release:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Anatomical</span> <span class="n">Template</span><span class="p">:</span>  <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="p">{</span><span class="n">site</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">participant</span><span class="p">}</span><span class="o">/</span><span class="n">anat</span><span class="o">/</span><span class="n">mprage_anonymized</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
<span class="n">Functional</span> <span class="n">Template</span><span class="p">:</span>  <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="p">{</span><span class="n">site</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">participant</span><span class="p">}</span><span class="o">/</span><span class="n">func</span><span class="o">/</span><span class="n">rest</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/fcon_structure.png" src="../_images/fcon_structure.png" />
</figure>
<p>Another example is the file structure used by the <a class="reference external" href="http://fcon_1000.projects.nitrc.org/indi/abide/">ABIDE</a> and <a class="reference external" href="http://fcon_1000.projects.nitrc.org/indi/adhd200/">ADHD-200</a> releases:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Anatomical</span> <span class="n">Template</span><span class="p">:</span>  <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="p">{</span><span class="n">site</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">participant</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">session</span><span class="p">}</span><span class="o">/</span><span class="n">anat_</span><span class="o">*/</span><span class="n">mprage</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
<span class="n">Functional</span> <span class="n">Template</span><span class="p">:</span>  <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="p">{</span><span class="n">site</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">participant</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">session</span><span class="p">}</span><span class="o">/</span><span class="n">rest_</span><span class="o">*/</span><span class="n">rest</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/abide_adhd_structure.png" src="../_images/abide_adhd_structure.png" />
</figure>
<p>A final example is the file structure used by the <a class="reference external" href="http://fcon_1000.projects.nitrc.org/indi/enhanced/">Enhanced Nathan Kline Institute-Rockland Sample</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Anatomical</span> <span class="n">Template</span><span class="p">:</span>  <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="p">{</span><span class="n">site</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">participant</span><span class="p">}</span><span class="o">/</span><span class="n">anat</span><span class="o">/</span><span class="n">mprage</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
<span class="n">Functional</span> <span class="n">Template</span><span class="p">:</span>  <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="p">{</span><span class="n">site</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">participant</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">session</span><span class="p">}</span><span class="o">/</span><span class="n">RfMRI_</span><span class="o">*/</span><span class="n">rest</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/nki-rs_template.png" src="../_images/nki-rs_template.png" />
</figure>
<p>Users experiencing difficulties defining file path templates may want to re-organize their data to match one of the examples above. If you manually define a file path template and encounter an error when attempting to generate participant lists, please <a class="reference internal" href="help"><span class="doc">contact us</span></a> and we will be happy to help.</p>
</section>
<section id="data-yaml-fields">
<h2>Data YAML Fields<a class="headerlink" href="#data-yaml-fields" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">cpac_data_config_setup.py</span></code> command line utility will produce a YAML file containing all of the participants and various properties associated with that participant, such as its ID, session number, the location of its resting-state/functional and anatomical scans. Before each participant definition there is a single line with a dash, which indicates that start of the property definitions. Participant properties are indented under this dash. To illustrate, see the sample participant definition below:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># example of data stored locally</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"></span>
<span class="w">    </span><span class="nt">subject_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sub01</span><span class="w"></span>
<span class="w">    </span><span class="nt">unique_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ses01</span><span class="w"></span>
<span class="w">    </span><span class="nt">anat</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/site01/sub01/ses01/anatomical.nii.gz</span><span class="w"></span>
<span class="w">    </span><span class="nt">creds_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">None</span><span class="w"></span>
<span class="w">    </span><span class="nt">func</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">scan_1</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">scan</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/site01/sub01/ses01/scan_1_func.nii.gz</span><span class="w"></span>
<span class="w">        </span><span class="nt">scan_parameters</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">acquisition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">seq+z</span><span class="w"></span>
<span class="w">          </span><span class="nt">firsttr (start volume index)</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="w"></span>
<span class="w">          </span><span class="nt">lasttr (final volume index)</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="w"></span>
<span class="w">          </span><span class="nt">reference</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">27</span><span class="w"></span>
<span class="w">          </span><span class="nt">tr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.0</span><span class="w"></span>
<span class="w">    </span><span class="nt">site</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">site01</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"></span>
<span class="w">    </span><span class="nt">subject_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sub02</span><span class="w"></span>
<span class="w">    </span><span class="nt">unique_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ses02</span><span class="w"></span>
<span class="w">    </span><span class="nt">anat</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/site01/sub02/ses02/anatomical.nii.gz</span><span class="w"></span>
<span class="w">    </span><span class="nt">creds_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">None</span><span class="w"></span>
<span class="w">    </span><span class="nt">func</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">scan_1</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">scan</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/site01/sub02/ses02/scan_1_func.nii.gz</span><span class="w"></span>
<span class="w">        </span><span class="nt">scan_parameters</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">None</span><span class="w"></span>
<span class="w">    </span><span class="nt">site</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">site01</span><span class="w"></span>

<span class="c1"># example of data stored on an AWS S3 bucket</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"></span>
<span class="w">    </span><span class="nt">subject_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sub200</span><span class="w"></span>
<span class="w">    </span><span class="nt">unique_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ses-1</span><span class="w"></span>
<span class="w">    </span><span class="nt">anat</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://s3_bucket/path/to/site_A/sub200/anatomical.nii.gz</span><span class="w"></span>
<span class="w">    </span><span class="nt">creds_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">None (or) /path/to/AWS_credentials.csv</span><span class="w"></span>
<span class="w">    </span><span class="nt">func</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">scan_name_REST</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">scan</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://s3_bucket/path/to/site_A/sub200/scan_name_REST_func.nii.gz</span><span class="w"></span>
<span class="w">        </span><span class="nt">scan_parameters</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://s3_bucket/path/to/site_A/scan_name_REST_func.json</span><span class="w"></span>
<span class="w">    </span><span class="nt">site</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">site_A</span><span class="w"></span>

<span class="c1"># with a brain mask for brain extraction (bypassing skull-stripping)</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"></span>
<span class="w">    </span><span class="nt">subject_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sub02</span><span class="w"></span>
<span class="w">    </span><span class="nt">unique_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ses02</span><span class="w"></span>
<span class="w">    </span><span class="nt">anat</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/site01/sub02/ses02/anatomical.nii.gz</span><span class="w"></span>
<span class="w">    </span><span class="nt">brain_mask</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/site01/sub02/ses02/brain-mask.nii.gz</span><span class="w"></span>
<span class="w">    </span><span class="nt">creds_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">None</span><span class="w"></span>
<span class="w">    </span><span class="nt">func</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">scan_1</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">scan</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/site01/sub02/ses02/scan_1_func.nii.gz</span><span class="w"></span>
<span class="w">        </span><span class="nt">scan_parameters</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">None</span><span class="w"></span>
<span class="w">    </span><span class="nt">site</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">site01</span><span class="w"></span>

<span class="c1"># with field map files for distortion correction</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"></span>
<span class="w">    </span><span class="nt">subject_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sub01</span><span class="w"></span>
<span class="w">    </span><span class="nt">unique_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ses01</span><span class="w"></span>
<span class="w">    </span><span class="nt">anat</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/site01/sub01/ses01/anatomical.nii.gz</span><span class="w"></span>
<span class="w">    </span><span class="nt">creds_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">None</span><span class="w"></span>
<span class="w">    </span><span class="nt">func</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">scan_1</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">scan</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/site01/sub01/ses01/scan_1_func.nii.gz</span><span class="w"></span>
<span class="w">        </span><span class="nt">fmap_phase</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/site01/sub01/ses01/scan_1_phase-diff.nii.gz</span><span class="w"></span>
<span class="w">        </span><span class="nt">fmap_mag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/site01/sub01/ses01/scan_1_magnitude.nii.gz</span><span class="w"></span>
<span class="w">    </span><span class="nt">site</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">site01</span><span class="w"></span>
</pre></div>
</div>
<p>Note that more than one functional scan is defined under the <cite>func</cite> key (i.e., multiple series), and that individual scan parameters can be defined to override the default settings.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index">
              <img class="logo" src="../_static/cpac_logo_vertical.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index">Table of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="release_notes/v1.8.4">Latest Release: Version 1.8.4 Beta (Jun 29, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick">1. C-PAC Quickstart</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2. Specify Your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipelines/pipeline_config">3. Select Your Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="preprocessing">4. Pre-Process Your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="derivatives">5. Compute Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="running">6. All Run Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_analysis">7. Run Group Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="output_dir">8. Check Your Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/index">9. Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="help">10. Troubleshoot</a></li>
<li class="toctree-l2"><a class="reference internal" href="rnotes">11. Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix">Appendix</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix#benchmark-package">Benchmark Package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license">License</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pipelines/pipeline_config" title="Setting Up A Pipeline Configuration"
             >next</a> |</li>
        <li class="right" >
          <a href="quick" title="C-PAC Quickstart"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.5.dev Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >User Documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Setting Up A Data Configuration File (Participant/Subject List)</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2012‒2022, C-PAC Developers. C-PAC is licensed under LGPL-3.0-or-later.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.0.
    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19224662-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-19224662-10');
    </script>
    <script defer src="https://fcp-indi.github.io/scripts/versionList.js"></script>

  </body>
</html>