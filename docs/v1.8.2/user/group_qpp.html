
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Quasi-Periodic Patterns (QPP) &#8212; C-PAC 1.8.2.dev Beta documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex" />
    <link rel="search" title="Search" href="../search" />
    <link rel="next" title="Check Your Outputs" href="output_dir" />
    <link rel="prev" title="Inter-subject Correlation (ISC) &amp; Inter-subject Functional Correlation (ISFC)" href="group_isc" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="output_dir" title="Check Your Outputs"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="group_isc" title="Inter-subject Correlation (ISC) &amp; Inter-subject Functional Correlation (ISFC)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.2.dev Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >Welcome to C-PAC’s user guide!</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="group_analysis" accesskey="U">Group-Level Analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Quasi-Periodic Patterns (QPP)</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="quasi-periodic-patterns-qpp">
<h1>Quasi-Periodic Patterns (QPP)<a class="headerlink" href="#quasi-periodic-patterns-qpp" title="Permalink to this headline">¶</a></h1>
<section id="introduction-and-background">
<h2>Introduction and Background<a class="headerlink" href="#introduction-and-background" title="Permalink to this headline">¶</a></h2>
<p>Quasi-Periodic Patterns are described as dominant spatio-temporal patterns that might recur throughout imaged time-series (Keilholz et al. 2014). The algorithm designed to detect these patterns by Majeed et al. (2009) has been implemented in Python as part of the C-PAC package.</p>
<p>The QPP algorithm produces both a “template”, a characteristic single instance of the QPP, and a time course corresponding to the QPP, in the functional data.
The templates generated are useful to compare the QPP’s timings and spatial extent across different subjects, while the time course of the QPP strength is useful to compare to other physiological signals (Majeed et al. 2009, Yousefi et al. 2018).
The optimal template is chosen from the given templates by summation of the values of its sliding correlation at local maxima, which are above a certain threshold (provided by the user) at the final iteration.
The template with the highest sum is designated as the most representative QPP.
Selected in this way, the most representative QPP is guaranteed to have high correlation and large numbers of occurrences relative to other templates (Yousefi et al. 2018).</p>
</section>
<section id="computation-and-analysis-consideration">
<h2>Computation and Analysis Consideration<a class="headerlink" href="#computation-and-analysis-consideration" title="Permalink to this headline">¶</a></h2>
<p>While QPP can be performed at an individual level, group QPP can provide far more significant results to compare and regress with other physiological signals.
Computation of QPP involves extracting the time courses of multiple participants and concatenating them, producing one large 4-dimensional dataset.
This data is scanned with a fixed Window Length (WL) starting at random time points to find repeating patterns within the functional data.
This is then repeated several times, based on the user’s input, to produce a template and the correlating time course.
The template is therefore an average of the segments of each scan with length WL.</p>
<p>It is important to note that QPP is computationally intensive, efficiency is important to keep in mind when using a large amount of subjects (&gt; 500). It might take around 15 minutes to run such a large extent of subjects.</p>
</section>
<section id="configuring-qpp">
<h2>Configuring QPP<a class="headerlink" href="#configuring-qpp" title="Permalink to this headline">¶</a></h2>
</section>
<section id="configuration-using-a-yaml-file">
<h2>Configuration Using a YAML File<a class="headerlink" href="#configuration-using-a-yaml-file" title="Permalink to this headline">¶</a></h2>
<p>To configure QPP options within a YAML file, add the following lines to your file (with appropriate substitutions for paths):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">runQPP </span><span class="p">:</span>  <span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">]</span>

<span class="nt">qpp_scan_inclusion </span><span class="p">:</span>
<span class="nt">qpp_session_inclusion </span><span class="p">:</span>
<span class="nt">qpp_stratification </span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">None</span>

<span class="nt">qpp_permutations</span><span class="p">:</span>  <span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="nt">qpp_window</span><span class="p">:</span>  <span class="l l-Scalar l-Scalar-Plain">30</span>

<span class="nt">qpp_initial_threshold</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.2</span>
<span class="nt">qpp_final_threshold</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.3</span>
<span class="nt">qpp_initial_threshold_iterations </span><span class="p">:</span>  <span class="l l-Scalar l-Scalar-Plain">20</span>

<span class="nt">qpp_iterations </span><span class="p">:</span>  <span class="l l-Scalar l-Scalar-Plain">15</span>
</pre></div>
</div>
</section>
<section id="references">
<h2>References:<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Keilholz SD et al. <a class="reference external" href="http://doi.org/10.1016/j.neuroimage.2013.09.029">Quasi-periodic patterns (QPP): large-scale dynamics in resting state fMRI that correlate with local infraslow electrical activity</a>. Neuroimage (2014).</p>
<p>Majeed W et al. <a class="reference external" href="http://doi.org/10.1002/jmri.21848">Spatiotemporal dynamics of low frequency fluctuations in BOLD fMRI of the rat</a>. J Magn Reson Imaging (2009).</p>
<p>Yousefi et al. <a class="reference external" href="http://doi.org/10.1016/j.neuroimage.2017.11.043">Quasi Periodic Patterns of Intrinsic Brain activity in Individuals and their relationship with global signals</a>. Neuroimage (2018).</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index">
              <img class="logo" src="../_static/cpac_logo_vertical.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index">Table of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index#the-c-pac-mission">The C-PAC Mission</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#latest-release-version-1-8-2-beta-dec-02-2021">Latest Release: Version 1.8.2 Beta (Dec 02, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#added">Added</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#changed">Changed</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#deprecated">Deprecated</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#fixed">Fixed</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#the-c-pac-team">The C-PAC Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#funding-acknowledgements">Funding Acknowledgements</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index#user-guide-index">User Guide Index</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="quick">1. C-PAC Quickstart</a></li>
<li class="toctree-l3"><a class="reference internal" href="subject_list_config">2. Specify Your Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipelines/pipeline_config">3. Select Your Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="preprocessing">4. Pre-Process Your Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="derivatives">5. Compute Derivatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="running">6. All Run Options</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="group_analysis">7. Run Group Analysis</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="group_fsl_feat">FSL FEAT &amp; Randomise</a></li>
<li class="toctree-l4"><a class="reference internal" href="group_pybasc">Bootstrapped Analysis of Stable Clusters (PyBASC)</a></li>
<li class="toctree-l4"><a class="reference internal" href="group_mdmr">Multivariate Distance Matrix Regression (MDMR)</a></li>
<li class="toctree-l4"><a class="reference internal" href="group_isc">Inter-subject Correlation (ISC) &amp; Inter-subject Functional Correlation (ISFC)</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Quasi-Periodic Patterns (QPP)</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#introduction-and-background">Introduction and Background</a></li>
<li class="toctree-l5"><a class="reference internal" href="#computation-and-analysis-consideration">Computation and Analysis Consideration</a></li>
<li class="toctree-l5"><a class="reference internal" href="#configuring-qpp">Configuring QPP</a></li>
<li class="toctree-l5"><a class="reference internal" href="#configuration-using-a-yaml-file">Configuration Using a YAML File</a></li>
<li class="toctree-l5"><a class="reference internal" href="#references">References:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="output_dir">8. Check Your Outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="help">9. Troubleshoot</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnotes">10. Release Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="appendix">Appendix</a></li>
<li class="toctree-l3"><a class="reference internal" href="appendix#benchmark-package">Benchmark Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index">Welcome to CPAC’s developer documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index#indices-and-tables">Indices and tables</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="output_dir" title="Check Your Outputs"
             >next</a> |</li>
        <li class="right" >
          <a href="group_isc" title="Inter-subject Correlation (ISC) &amp; Inter-subject Functional Correlation (ISFC)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.2.dev Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >Welcome to C-PAC’s user guide!</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="group_analysis" >Group-Level Analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Quasi-Periodic Patterns (QPP)</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, C-PAC Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.1.
    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19224662-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-19224662-10');
    </script>
    <script defer src="https://fcp-indi.github.io/scripts/versionList.js"></script>

  </body>
</html>