
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>FSL-FEAT/Randomise Group Analysis &#8212; C-PAC 1.8.4.dev Beta documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex" />
    <link rel="search" title="Search" href="../search" />
    <link rel="next" title="Bootstrapped Analysis of Stable Clusters (PyBASC)" href="group_pybasc" />
    <link rel="prev" title="Group-Level Analysis" href="group_analysis" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="group_pybasc" title="Bootstrapped Analysis of Stable Clusters (PyBASC)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="group_analysis" title="Group-Level Analysis"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.4.dev Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="group_analysis" accesskey="U">Group-Level Analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">FSL-FEAT/Randomise Group Analysis</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="fsl-feat-randomise-group-analysis">
<h1>FSL-FEAT/Randomise Group Analysis<a class="headerlink" href="#fsl-feat-randomise-group-analysis" title="Permalink to this headline">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>C-PAC uses the <a class="reference external" href="http://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FEAT/UserGuide">FSL/FEAT</a> tool to compare findings across groups. You can construct models using a participant list and a phenotype file, select derivatives to be predicted by the model, and define contrasts between conditions using a custom CSV file. Then FSL/FEAT will run a second-level <a class="reference external" href="http://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FEAT/UserGuide#Appendix_A:_Brief_Overview_of_GLM_Analysis">General Linear Model (GLM)</a> for you.</p>
<p>In addition, FMRIB’s FSL Randomise package is also available in C-PAC for the execution of non-parametric permutation inference. FSL-Randomise can use the same group models you generate or build/edit via the C-PAC model builder for FSL-FEAT.</p>
<p>There are two ways to set up FSL-FEAT/Randomise group-level analysis for C-PAC:</p>
<ul class="simple">
<li><p><strong>The FLAME Model Presets</strong>: this allows you to generate a pre-configured analysis model.</p></li>
<li><p><strong>The Group Analysis Model Builder</strong>: this allows you to specify a model from scratch, or to modify any of the generated presets mentioned above.</p></li>
</ul>
<p>The following links provide an introduction to how groups are compared using FSL, as well as how to define contrasts:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.fmrib.ox.ac.uk/fslcourse/lectures/feat1_part2.pdf">http://www.fmrib.ox.ac.uk/fslcourse/lectures/feat1_part2.pdf</a></p></li>
</ul>
</section>
<section id="group-analysis-fsl-feat-randomise-presets">
<h2>Group Analysis FSL-FEAT/Randomise Presets<a class="headerlink" href="#group-analysis-fsl-feat-randomise-presets" title="Permalink to this headline">¶</a></h2>
<p>C-PAC has a selection of model presets designed to run commonly-used group analysis designs for FSL-FEAT/FLAME. These correspond to examples provided on <a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FEAT/UserGuide">FSL’s user guide for FEAT/FLAME</a>. The preset generator will create a group analysis YAML configuration file that you can plug directly into C-PAC and run.</p>
<p>The presets that are generated:</p>
<ul class="simple">
<li><p>are meant to get you up and running quickly</p></li>
<li><p>are in the form of a group analysis configuration YAML file that can be plugged directly into C-PAC and run</p></li>
<li><p>include a complete design matrix as an input, which you can view before running</p></li>
<li><p>include already-configured contrasts in a custom contrasts .CSV file, which can be edited before running</p></li>
<li><p>can be modified to your liking either by using the standard Group Analysis Model Builder, or by hand via text editor</p></li>
<li><p>are all in one place in the output directory you specify in the Preset Generator</p></li>
</ul>
<p><strong>Preset options</strong>: Currently, there are 5 presets to choose from. More are on their way. If you have any commonly-used or useful group model designs you’d like to see as a preset, <a class="reference external" href="https://groups.google.com/forum/#!forum/cpax_forum">please let us know</a>!</p>
<p>The available presets are:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FEAT/UserGuide#Single-Group_Average_.28One-Sample_T-Test.29">Single Group Average (One-Sample T-Test)</a></p></li>
<li><p><a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FEAT/UserGuide#Single-Group_Average_with_Additional_Covariate">Single Group Average with Additional Covariate</a></p></li>
<li><p><a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FEAT/UserGuide#Unpaired_Two-Group_Difference_.28Two-Sample_Unpaired_T-Test.29">Unpaired Two-Group Difference (Two-Sample Unpaired T-Test)</a></p></li>
<li><p><a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FEAT/UserGuide#Paired_Two-Group_Difference_.28Two-Sample_Paired_T-Test.29">Paired Two-Group Difference (Two-Sample Paired T-Test)</a></p></li>
<li><p><a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FEAT/UserGuide#Tripled_Two-Group_Difference_.28.22Tripled.22_T-Test.29">Tripled Two-Group Difference (‘Tripled’ T-Test)</a></p></li>
</ul>
<section id="from-terminal">
<h3>From Terminal<a class="headerlink" href="#from-terminal" title="Permalink to this headline">¶</a></h3>
<p>You can generate any of these presets using the C-PAC command-line interface (CLI):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cpac group feat load_preset &lt;preset type&gt;</span>
</pre></div>
</div>
<p>Enter any of the following in place of <code class="file docutils literal notranslate"><span class="pre">&lt;preset</span> <span class="pre">type&gt;</span></code> for the type of analysis you want to run:</p>
<ul class="simple">
<li><p><strong>single_grp_avg</strong> - Single Group Average (One-Sample T-Test)</p></li>
<li><p><strong>single_grp_cov</strong> - Single Group Average with Additional Covariate</p></li>
<li><p><strong>unpaired_two</strong> - Unpaired Two-Group Difference (Two-Sample Unpaired T-Test)</p></li>
<li><p><strong>paired_two</strong> - Paired Two-Group Difference (Two-Sample Paired T-Test)</p></li>
<li><p><strong>tripled_two</strong> - Tripled Two-Group Difference (‘Tripled’ T-Test)</p></li>
</ul>
<p>You can get more information about the required inputs for each preset with the <code class="file docutils literal notranslate"><span class="pre">--help</span></code> flag. For example, to check the parameters for a two-sample unpaired t-test:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cpac group feat load_preset unpaired_two --help</span>
</pre></div>
</div>
<p>This will produce:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Usage: cpac group feat load_preset unpaired_two [OPTIONS] GROUP_PARTICIPANTS</span>
<span class="go">                                                Z_THRESH P_THRESH PHENO_FILE</span>
<span class="go">                                                PHENO_SUB COVARIATE MODEL_NAME</span>
<span class="go">Options:</span>
<span class="go">  --output_dir TEXT</span>
<span class="go">  --help             Show this message and exit.</span>
</pre></div>
</div>
<p>Following this, you could generate a ready-to-run two-sample unpaired t-test by running the following, assuming the phenotype CSV has a column of participant IDs named “subject_id” and a column named “diagnosis”, which is the covariate you wish to test:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cpac group feat load_preset unpaired_two /path/to/group_participant_list.txt 2.3 0.05</span>
<span class="go">        /path/to/phenotypic_file.csv subject_id diagnosis grp_analysis1</span>
<span class="go">        --output_dir /path/to/output_dir</span>
</pre></div>
</div>
<p>You will receive a message like this shortly after:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Group-level analysis participant list written:</span>
<span class="go">/path/to/output_dir/group_analysis_participants.txt</span>

<span class="go">CSV file written:</span>
<span class="go">/path/to/output_dir/cpac_group_analysis/grp_analysis1/design_matrix_grp_analysis1.csv</span>

<span class="go">CSV file written:</span>
<span class="go">/path/to/output_dir/cpac_group_analysis/grp_analysis1/contrasts_matrix_grp_analysis1.csv</span>

<span class="go">Group-level analysis configuration YAML file written:</span>
<span class="go">/path/to/output_dir/cpac_group_analysis/grp_analysis1/group_config_grp_analysis1.yml</span>
</pre></div>
</div>
<p>The message indicates that all of the associated files have been generated. Most importantly, it generated a group configuration file that you can use to build and run your model. Once complete, you can review the model generated to make sure it meets your expectations. If you wish to tweak the model generated by a preset, you can load the group configuration file into the model builder (more details below) and make any modifications necessary.</p>
<p>When you are happy with your model, you can go ahead to build the model for each of your selected derivatives:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cpac group feat build-models /path/to/group_config.yml</span>
</pre></div>
</div>
<p>Once this is complete, a design matrix will have been generated for each derivative, session, scan, and nuisance regression strategy you had in your pipeline directory. These are available for review in the group-level analysis output directory you specified in your group configuration file (or during preset generation). In addition, a <code class="docutils literal notranslate"><span class="pre">contrasts.csv</span></code> file will be generated in the top level of the FSL group model directory (in your selected group-level analysis output directory). This contrasts file will be set up in accordance with the design matrices created for your pipeline outputs, and will look like this:</p>
<figure class="align-default">
<img alt="../_images/ga_contrast_csv.png" src="../_images/ga_contrast_csv.png" />
</figure>
<p>The first column should be filled with labels for the contrasts that you can define - these do not have to follow any particular convention, and can be whatever works best for your experiment.  The remainder of the cells can be populated with contrast weights according to your needs.</p>
<p>If you would like to add f-tests, add each f-test as a column to the CSV with the label <code class="docutils literal notranslate"><span class="pre">f_test_#</span></code> and the assign weights to each contrast to be included in the f-test.</p>
<figure class="align-default">
<img alt="../_images/ga_contrast_ftest.png" src="../_images/ga_contrast_ftest.png" />
</figure>
<p>Once you have specified your contrasts, you can start FSL FEAT or Randomise with the commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cpac group feat run /path/to/group_config.yml</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cpac group feat randomise /path/to/group_config.yml</span>
</pre></div>
</div>
</section>
</section>
<section id="c-pac-group-analysis-model-builder">
<h2>C-PAC Group Analysis Model Builder<a class="headerlink" href="#c-pac-group-analysis-model-builder" title="Permalink to this headline">¶</a></h2>
<p>Use the model builder to create an FSL FEAT/Randomise model from scratch, or to modify any of the generated presets.</p>
<section id="from-the-terminal">
<h3>From the terminal<a class="headerlink" href="#from-the-terminal" title="Permalink to this headline">¶</a></h3>
<p>Similar to the pipeline configuration YAML file, the group configuration YAML file allows you to configure your runs with key-value combinations. From terminal, you can quickly generate a default group configuration YAML file template in the directory you are in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cpac</span> <span class="n">utils</span> <span class="n">group_config</span> <span class="n">new_template</span>
</pre></div>
</div>
<p>This will generate a group configuration file that you can then modify to make your selections. See below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># General Group-Level Analysis Settings</span>
<span class="c1">##############################################################################</span>

<span class="c1"># The main input of group-level analysis- the output directory of your individual-level analysis pipeline run (pre-processing &amp; derivatives for each participant). This should be a path to your C-PAC individual-level run&#39;s pipeline folder, which includes the sub-directories labeled with the participant IDs.</span>
<span class="n">pipeline_dir</span><span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">output_dir</span>


<span class="c1"># (Optional) Full path to a list of participants to be included in the model. You can use this to easily prune participants from your model. In group-level analyses involving phenotype files, this allows you to prune participants without removing them from the phenotype CSV/TSV file. This should be a text file with one subject per line. An easy way to manually create this file is to copy the participant ID column from your phenotype file.</span>
<span class="n">participant_list</span><span class="p">:</span> <span class="kc">None</span>


<span class="c1"># Full path to the directory where CPAC should place group-level analysis outputs and any applicable statistical model files.</span>
<span class="n">output_dir</span><span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">output</span><span class="o">/</span><span class="nb">dir</span>


<span class="c1">#Much like the working directory for individual-level analysis, this is where the intermediate and working files will be stored during your run. This directory can be deleted later on. However, saving this directory allows the group analysis run to skip steps that have been already completed, in the case of re-runs.</span>
<span class="n">work_dir</span><span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="nb">dir</span>


<span class="c1">#Where to write out log information for your group analysis run.</span>
<span class="n">log_dir</span><span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="nb">dir</span>


<span class="c1"># The path to your FSL installation directory. This can be left as &#39;FSLDIR&#39; to grab your system&#39;s default FSL installation. However, if you prefer to use a specific install of FSL, you can enter the path here.</span>
<span class="n">FSLDIR</span><span class="p">:</span> <span class="n">FSLDIR</span>


<span class="c1"># FSL-FEAT</span>
<span class="c1">##############################################################################</span>

<span class="c1"># Run FSL FEAT group-level analysis.</span>
<span class="n">run_fsl_feat</span> <span class="p">:</span>  <span class="p">[</span><span class="mi">1</span><span class="p">]</span>


<span class="c1"># How many statistical models to run in parallel. This number depends on computing resources.</span>
<span class="n">num_models_at_once</span> <span class="p">:</span>  <span class="mi">1</span>


<span class="c1"># Specify a name for the new model.</span>
<span class="n">model_name</span><span class="p">:</span> <span class="n">model_name_here</span>


<span class="c1"># Phenotype file</span>
<span class="c1"># Full path to a .csv or .tsv file containing EV/regressor information for each subject.</span>
<span class="n">pheno_file</span><span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">phenotypic</span><span class="o">/</span><span class="n">file</span><span class="o">.</span><span class="n">csv</span>


<span class="c1"># Name of the participants column in your phenotype file.</span>
<span class="n">participant_id_label</span><span class="p">:</span> <span class="n">Participant</span>


<span class="c1"># Specify which EVs from your phenotype are categorical or numerical. Of those which are numerical, specify which are to be demeaned.</span>
<span class="c1"># ev_selections: {&#39;demean&#39;: [&#39;Age&#39;], &#39;categorical&#39;: [&#39;Sex&#39;, &#39;Diagnosis&#39;]}</span>
<span class="n">ev_selections</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;demean&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;categorical&#39;</span><span class="p">:</span> <span class="p">[]}</span>


<span class="c1"># Specify the formula to describe your model design. Essentially, including EVs in this formula inserts them into the model. The most basic format to include each EV you select would be &#39;EV + EV + EV + ..&#39;, etc. You can also select to include MeanFD, Measure_Mean, and Custom_ROI_Mean here. See the C-PAC User Guide for more detailed information regarding formatting your design formula.</span>
<span class="c1"># design_formula: Sex + Diagnosis + Age + MeanFD_Jenkinson + Custom_ROI_Mean</span>
<span class="n">design_formula</span><span class="p">:</span>


<span class="c1"># Choose the derivatives to run the group model on.</span>
<span class="c1">#</span>
<span class="c1"># These must be written out as a list, and must be one of the options listed below.</span>
<span class="c1">#</span>
<span class="c1"># For z-scored analyses:</span>
<span class="c1"># &#39;alff_to_standard_zstd&#39;, &#39;alff_to_standard_smooth_zstd&#39;, &#39;falff_to_standard_zstd&#39;, &#39;falff_to_standard_smooth_zstd&#39;, &#39;reho_to_standard_zstd&#39;, &#39;reho_to_standard_smooth_zstd&#39;, &#39;sca_roi_files_to_standard_fisher_zstd&#39;, &#39;sca_roi_files_to_standard_smooth_fisher_zstd&#39;, &#39;vmhc_fisher_zstd_zstat_map&#39;, &#39;dr_tempreg_maps_zstat_files_to_standard&#39;, &#39;dr_tempreg_maps_zstat_files_to_standard_smooth&#39;, &#39;sca_tempreg_maps_zstat_files&#39;, &#39;sca_tempreg_maps_zstat_files_smooth&#39;, &#39;centrality_outputs_zstd&#39;, &#39;centrality_outputs_smoothed_zstd&#39;</span>
<span class="c1">#</span>
<span class="c1"># Example input: derivative_list :  [&#39;alff_to_standard_smooth_zstd&#39;, &#39;sca_roi_files_to_standard_smooth_fisher_zstd&#39;]</span>
<span class="c1">#</span>
<span class="n">derivative_list</span><span class="p">:</span> <span class="p">[]</span>


<span class="c1"># Choose whether to use a group mask or individual-specific mask when calculating the output means to be used as a regressor.</span>
<span class="c1">#</span>
<span class="c1"># This only takes effect if you include the &#39;Measure_Mean&#39; regressor in your Design Matrix Formula.</span>
<span class="n">mean_mask</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Group Mask&#39;</span><span class="p">]</span>


<span class="c1"># Full path to a NIFTI file containing one or more ROI masks. The means of the masked regions will then be computed for each subject&#39;s output and will be included in the model as regressors (one for each ROI in the mask file) if you include &#39;Custom_ROI_Mean&#39; in the Design Matrix Formula.</span>
<span class="c1"># custom_roi_mask: /path/to/mask.nii.gz</span>
<span class="n">custom_roi_mask</span><span class="p">:</span> <span class="kc">None</span>


<span class="c1"># Choose the coding scheme to use when generating your model. &#39;Treatment&#39; encoding is generally considered the typical scheme. Consult the User Guide for more information.</span>
<span class="c1">#</span>
<span class="c1"># Available options:</span>
<span class="c1"># &#39;Treatment&#39;, &#39;Sum&#39;</span>
<span class="c1">#</span>
<span class="n">coding_scheme</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Treatment&#39;</span><span class="p">]</span>


<span class="c1"># Specify whether FSL should model the variance for each group separately.</span>
<span class="c1">#</span>
<span class="c1"># If this option is enabled, you must specify a grouping variable below.</span>
<span class="n">group_sep</span><span class="p">:</span> <span class="n">Off</span>


<span class="c1"># The name of the EV that should be used to group subjects when modeling variances.</span>
<span class="c1">#</span>
<span class="c1"># If you do not wish to model group variances separately, set this value to None.</span>
<span class="n">grouping_var</span><span class="p">:</span> <span class="kc">None</span>


<span class="c1"># Only voxels with a Z-score higher than this value will be considered significant.</span>
<span class="n">z_threshold</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2.3&#39;</span><span class="p">]</span>


<span class="c1"># Significance threshold (P-value) to use when doing cluster correction for multiple comparisons.</span>
<span class="n">p_threshold</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0.05&#39;</span><span class="p">]</span>


<span class="c1"># For repeated measures only. Enter the session names in your dataset that you wish to include within the same model (this is for repeated measures / within-subject designs).\n\nTip: These will be the names listed as &quot;unique_id&quot; in the original individual-level participant list, or the labels in the original data directories you marked as {session} while creating the CPAC participant list.</span>
<span class="c1"># sessions_list: [&#39;ses-01&#39;, &#39;ses-02&#39;]</span>
<span class="n">sessions_list</span><span class="p">:</span> <span class="p">[]</span>


<span class="c1"># For repeated measures only. Enter the series names in your dataset that you wish to include within the same model (this is for repeated measures / within-subject designs).\n\nTip: These will be the labels listed under &quot;func:&quot; in the original individual-level participant list, or the labels in the original data directories you marked as {series} while creating the CPAC participant list.</span>
<span class="c1"># series_list: [&#39;task-rest_run-1&#39;, &#39;task-rest_run-2&#39;]</span>
<span class="n">series_list</span><span class="p">:</span> <span class="p">[]</span>


<span class="c1"># Specify your contrasts here. For example, if two of your available contrasts are EV1 and EV0, you can enter contrast descriptions such as &#39;EV1 - EV0 = 0&#39; or &#39;EV1 = 0&#39;. Consult the User Guide for more information about describing contrasts. Alternatively, you can provide your own custom-written contrasts matrix in a CSV file in the &#39;Custom Contrasts Matrix&#39; field below.</span>
<span class="c1"># contrasts: [&#39;C(Diagnosis)[T.ADHD] - C(Diagnosis)[T.Typical] = 0&#39;, &#39;C(Diagnosis)[T.Typical] - C(Diagnosis)[T.ADHD] = 0&#39;]</span>
<span class="n">contrasts</span><span class="p">:</span> <span class="p">[]</span>


<span class="c1"># Optional: A list of f-test strings containing contrasts. If you do not wish to run f-tests, leave this blank.</span>
<span class="n">f_tests</span><span class="p">:</span> <span class="p">[]</span>


<span class="c1"># Optional: Full path to a CSV file which specifies the contrasts you wish to run in group analysis. Consult the User Guide for proper formatting.</span>
<span class="c1"># If you wish to use the standard contrast builder, leave this field blank. If you provide a path for this option, CPAC will use your custom contrasts matrix instead, and will use the f-tests described in this custom file only (ignoring those you have input in the f-tests field above).</span>
<span class="c1"># If you wish to include f-tests, create a new column in your CSV file for each f-test named &#39;f_test_1&#39;, &#39;f_test_2&#39;, .. etc. Then, mark the contrasts you would like to include in each f-test with a 1, and mark the rest 0. Note that you must select at least two contrasts per f-test.</span>
<span class="n">custom_contrasts</span><span class="p">:</span> <span class="kc">None</span>


<span class="c1"># FSL-Randomise</span>
<span class="c1">##############################################################################</span>

<span class="c1"># Run Randomise</span>
<span class="n">run_randomise</span> <span class="p">:</span>  <span class="p">[</span><span class="mi">0</span><span class="p">]</span>


<span class="c1"># Number of permutations you would like to use when building up the null distribution to test against.</span>
<span class="n">randomise_permutation</span> <span class="p">:</span>  <span class="mi">500</span>


<span class="c1"># Cluster-based thresholding corrected for multiple comparisons by using the null distribution of the max (across the image) cluster mask.</span>
<span class="n">randomise_thresh</span> <span class="p">:</span>  <span class="mi">5</span>


<span class="c1"># Demean data temporally before model fitting.</span>
<span class="n">randomise_demean</span> <span class="p">:</span>  <span class="kc">True</span>


<span class="c1"># From the FMRIB FSL-Randomise user guide: TFCE (Threshold-Free Cluster Enhancement) is a new method for finding &#39;clusters&#39; in your data without having to define clusters in a binary way. Cluster-like structures are enhanced but the image remains fundamentally voxelwise.</span>
<span class="n">randomise_tfce</span> <span class="p">:</span>  <span class="kc">True</span>
</pre></div>
</div>
<p>When you are done specifying your model, you can go ahead to build the model for each of your selected derivatives:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cpac group feat build-models /path/to/group_config.yml</span>
</pre></div>
</div>
<p>Once this is complete, a design matrix will have been generated for each derivative, session, scan, and nuisance regression strategy you had in your pipeline directory. These are available for review in the group-level analysis output directory you specified in your group configuration file (or during preset generation). In addition, a <code class="docutils literal notranslate"><span class="pre">contrasts.csv</span></code> file will be generated in the top level of the FSL group model directory (in your selected group-level analysis output directory). This contrasts file will be set up in accordance with the design matrices created for your pipeline outputs, and will look like this:</p>
<figure class="align-default">
<img alt="../_images/ga_contrast_csv.png" src="../_images/ga_contrast_csv.png" />
</figure>
<p>The first column should be filled with labels for the contrasts that you can define - these do not have to follow any particular convention, and can be whatever works best for your experiment.  The remainder of the cells can be populated with contrast weights according to your needs.</p>
<p>If you would like to add f-tests, add each f-test as a column to the CSV with the label <code class="docutils literal notranslate"><span class="pre">f_test_#</span></code> and the assign weights to each contrast to be included in the f-test.</p>
<figure class="align-default">
<img alt="../_images/ga_contrast_ftest.png" src="../_images/ga_contrast_ftest.png" />
</figure>
<p>Once you have specified your contrasts, you can start FSL FEAT or Randomise with the commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cpac group feat run /path/to/group_config.yml</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cpac group feat randomise /path/to/group_config.yml</span>
</pre></div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index">
              <img class="logo" src="../_static/cpac_logo_vertical.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="../index">Table of Contents</a></h3>
    <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="release_notes/v1.8.3">Latest Release: Version 1.8.3 Beta (Feb 11, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick">1. C-PAC Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="subject_list_config">2. Specify Your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipelines/pipeline_config">3. Select Your Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="preprocessing">4. Pre-Process Your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="derivatives">5. Compute Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="running">6. All Run Options</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="group_analysis">7. Run Group Analysis</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">FSL FEAT &amp; Randomise</a></li>
<li class="toctree-l3"><a class="reference internal" href="group_pybasc">Bootstrapped Analysis of Stable Clusters (PyBASC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="group_mdmr">Multivariate Distance Matrix Regression (MDMR)</a></li>
<li class="toctree-l3"><a class="reference internal" href="group_isc">Inter-subject Correlation (ISC) &amp; Inter-subject Functional Correlation (ISFC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="group_qpp">Quasi-Periodic Patterns (QPP)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="output_dir">8. Check Your Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="help">9. Troubleshoot</a></li>
<li class="toctree-l2"><a class="reference internal" href="rnotes">10. Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix">Appendix</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix#benchmark-package">Benchmark Package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index">Developer Documentation</a></li>
</ul>

  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="group_pybasc" title="Bootstrapped Analysis of Stable Clusters (PyBASC)"
             >next</a> |</li>
        <li class="right" >
          <a href="group_analysis" title="Group-Level Analysis"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.4.dev Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="group_analysis" >Group-Level Analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">FSL-FEAT/Randomise Group Analysis</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, C-PAC Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19224662-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-19224662-10');
    </script>
    <script defer src="https://fcp-indi.github.io/scripts/versionList.js"></script>

  </body>
</html>