
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Multivariate Distance Matrix Regression (MDMR) &#8212; C-PAC 1.8.1 Beta documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex" />
    <link rel="search" title="Search" href="../search" />
    <link rel="next" title="Inter-subject Correlation (ISC) &amp; Inter-subject Functional Correlation (ISFC)" href="group_isc" />
    <link rel="prev" title="Bootstrapped Analysis of Stable Clusters (PyBASC)" href="group_pybasc" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="group_isc" title="Inter-subject Correlation (ISC) &amp; Inter-subject Functional Correlation (ISFC)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="group_pybasc" title="Bootstrapped Analysis of Stable Clusters (PyBASC)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.1 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >Welcome to C-PAC’s user guide!</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="group_analysis" accesskey="U">Group-Level Analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Multivariate Distance Matrix Regression (MDMR)</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="multivariate-distance-matrix-regression-mdmr">
<h1>Multivariate Distance Matrix Regression (MDMR)<a class="headerlink" href="#multivariate-distance-matrix-regression-mdmr" title="Permalink to this headline">¶</a></h1>
<section id="introduction-background">
<h2>Introduction &amp; Background<a class="headerlink" href="#introduction-background" title="Permalink to this headline">¶</a></h2>
<p>Connectome-wide Association Studies (CWAS) allow researchers to explore relationships between patterns of functional connectivity (the functional connectome), behavior, and phenotypic factors. The CWAS method that is implemented in C-PAC (Shehzad et al., 2014) examines the correlation among patterns of functional connectivity and phenotypes using the Multivariate Distance Matrix Regression (MDMR; Reiss et al., 2010). Compared to traditional univariate techniques which require rigorous correction for multiple comparisons, a multivariate approach significantly reduces the number of connectivity-phenotype comparisons needed to run a CWAS (Shehzad et al., 2014).</p>
</section>
<section id="computation-and-analysis-considerations">
<h2>Computation and Analysis Considerations<a class="headerlink" href="#computation-and-analysis-considerations" title="Permalink to this headline">¶</a></h2>
<p>Computation steps for CWAS are listed below as described by Shehzad and colleagues (2014).</p>
<ol class="arabic simple">
<li><p>For each subject, C-PAC computes the correlation of BOLD signals between every possible pair of gray matter voxels, resulting in a V x V correlation matrix for each subject (where V is the number of gray matter voxels).</p></li>
<li><p>To determine individual differences, patterns of whole-brain connectivity for each voxel are compared to the connectivity pattern for the same voxel between all possible pairs of subjects. A distance matrix is then computed which represents the dissimilarity between whole-brain connectivity patterns for any pair of subjects.</p></li>
<li><p>MDMR is then used to test whether, for each voxel, whole-brain connectivity patterns tend to be more similar for individuals with like phenotypes (within-group) than individuals with unlike phenotypes (between-group). This quantifies how well phenotypic variables explain the distances between participants in the distance matrix.</p></li>
<li><p>The significance of these similarities and differences is assessed with a permutation test. This identifies brain regions whose whole-brain pattern of connectivity is significantly predicted by a particular phenotypic variable.</p></li>
</ol>
<p>The figure below (taken from Shehzad et al., 2010) outlines these steps. For more detail on how C-PAC handles these computations, please see the <a class="reference external" href="http://fcp-indi.github.io/docs/developer/workflows/cwas.html">CWAS section of the developer documentation</a>.</p>
<figure class="align-default">
<img alt="../_images/cwas_shehzad_schematic.png" src="../_images/cwas_shehzad_schematic.png" />
</figure>
<p>It is important to note that the results of MDMR analysis do not contain information about the direction of connectivity-phenotype relationships, nor the specific connections underlying these connectome-wide associations. Follow-up analysis using seed-based correlation analysis (or similar methods) is required to discover this information (Shehzad et al., 2014). To avoid bias caused by ‘double-dipping’ your data (Kriegeskorte et al., 2009), this analysis should always be performed on an independent sample (Shehzad et al., 2014). Further, the results of these follow-up analyses should take into account existing knowledge about brain anatomy and physiology before being considered definitive (Shehzad et al., 2014).</p>
</section>
<section id="applications-and-recommendations">
<h2>Applications and Recommendations<a class="headerlink" href="#applications-and-recommendations" title="Permalink to this headline">¶</a></h2>
<p>As C-PAC is one of the first public software packages to implement CWAS, it has yet to be utilized by more than a few researchers. The most notable use to date is the analysis performed by Shehzad and colleagues, who found robust associations between functional connectivity and a number of phenotypic characteristics including age, ADHD diagnosis, IQ, and <em>L-dopa</em> administration.</p>
<figure class="align-default">
<img alt="../_images/cwas_shehzad_brains.png" src="../_images/cwas_shehzad_brains.png" />
</figure>
<p>As CWAS examines connectivity across the whole brain, it may have reduced sensitivity to highly-localized sets of connections related to a phenotype. This issue can be addressed by limiting analysis to connectivity between specific anatomical regions (Shehzad et al., 2014), which can be accomplished by defining an ROI mask during C-PAC setup.</p>
</section>
<section id="configuring-cwas">
<h2>Configuring CWAS<a class="headerlink" href="#configuring-cwas" title="Permalink to this headline">¶</a></h2>
<section id="configuration-using-a-yaml-file">
<h3>Configuration Using a YAML File<a class="headerlink" href="#configuration-using-a-yaml-file" title="Permalink to this headline">¶</a></h3>
<p>To configure CWAS options within a YAML file, add the following lines to your file (with appropriate substitutions for paths):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">runCWAS = [0]</span>
<span class="l l-Scalar l-Scalar-Plain">cwas_roi_file = &#39;/path/to/cwas_mask_file&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">cwas_regressor_file = &#39;/path/to/cwas_regressor_file&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">cwas_regressor_participant_column = &#39;ID</span>
<span class="l l-Scalar l-Scalar-Plain">cwas_regressor_columns = [&#39;FIQ&#39;, &#39;VIQ&#39;, &#39;PIQ&#39;]</span>
<span class="l l-Scalar l-Scalar-Plain">cwas_permutations = 500</span>
<span class="l l-Scalar l-Scalar-Plain">cwas_parallel_nodes = 3</span>
</pre></div>
</div>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Reiss, P.T., Stevens, M.H.H., Shehzad, Z., Petkova, E. &amp; Milham, M.P. <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/19673867">On distance-based permutation tests for between-group comparisons</a>. Biometrics 66, 636–643 (2010).</p>
<p>Shehzad, Z., Kelly, C., Reiss, P.T., Craddock, C.R., Emerson, J.W., McMahon, K., Copland, D.A., Castellanos, F.X., &amp; Milham, M.P. <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/24583255">An Analytic Framework for Connectome-Wide Association Studies</a>. Neuroimage, 93 Pt 1, 74–94 (2014).</p>
<p>Kriegeskorte, N., Simmons, W.K., Bellgowan, P.S.F. &amp; Baker, C.I. <a class="reference external" href="http://www.mrc-cbu.cam.ac.uk/people/nikolaus.kriegeskorte/Kriegeskorte%20Simmons%20Bellgowan%20&amp;%20Baker_Circular%20analysis%20in%20systems%20neuroscience_incl%20supplement_author%20version.pdf">Circular analysis in systems neuroscience: the dangers of double dipping</a>. Nat Neurosci 12, 535–540 (2009)</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index">
              <img class="logo" src="../_static/cpac_logo_vertical.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index">Table of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index#the-c-pac-mission">The C-PAC Mission</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#latest-release-version-1-8-1-beta-sep-17-2021">Latest Release: Version 1.8.1 Beta (Sep 17, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#the-c-pac-team">The C-PAC Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#funding-acknowledgements">Funding Acknowledgements</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index#user-guide-index">User Guide Index</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="quick">1. C-PAC Quickstart</a></li>
<li class="toctree-l3"><a class="reference internal" href="subject_list_config">2. Specify Your Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipelines/pipeline_config">3. Select Your Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="preprocessing">4. Pre-Process Your Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="derivatives">5. Compute Derivatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="running">6. All Run Options</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="group_analysis">7. Run Group Analysis</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="group_fsl_feat">FSL FEAT &amp; Randomise</a></li>
<li class="toctree-l4"><a class="reference internal" href="group_pybasc">Bootstrapped Analysis of Stable Clusters (PyBASC)</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Multivariate Distance Matrix Regression (MDMR)</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#introduction-background">Introduction &amp; Background</a></li>
<li class="toctree-l5"><a class="reference internal" href="#computation-and-analysis-considerations">Computation and Analysis Considerations</a></li>
<li class="toctree-l5"><a class="reference internal" href="#applications-and-recommendations">Applications and Recommendations</a></li>
<li class="toctree-l5"><a class="reference internal" href="#configuring-cwas">Configuring CWAS</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#configuration-using-a-yaml-file">Configuration Using a YAML File</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="group_isc">Inter-subject Correlation (ISC) &amp; Inter-subject Functional Correlation (ISFC)</a></li>
<li class="toctree-l4"><a class="reference internal" href="group_qpp">Quasi-Periodic Patterns (QPP)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="output_dir">8. Check Your Outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="help">9. Troubleshoot</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnotes">10. Release Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="appendix">Appendix</a></li>
<li class="toctree-l3"><a class="reference internal" href="appendix#benchmark-package">Benchmark Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index">Welcome to CPAC’s developer documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index#indices-and-tables">Indices and tables</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="group_isc" title="Inter-subject Correlation (ISC) &amp; Inter-subject Functional Correlation (ISFC)"
             >next</a> |</li>
        <li class="right" >
          <a href="group_pybasc" title="Bootstrapped Analysis of Stable Clusters (PyBASC)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.1 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >Welcome to C-PAC’s user guide!</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="group_analysis" >Group-Level Analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Multivariate Distance Matrix Regression (MDMR)</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, C-PAC Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19224662-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-19224662-10');
    </script>
    <script defer src="https://fcp-indi.github.io/scripts/versionList.js"></script>

  </body>
</html>