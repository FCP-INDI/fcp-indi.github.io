
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Benchmark Package &#8212; C-PAC 1.8.2.dev Beta documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex" />
    <link rel="search" title="Search" href="../search" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.2.dev Beta documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Benchmark Package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="benchmark-package">
<h1>Benchmark Package<a class="headerlink" href="#benchmark-package" title="Permalink to this headline">¶</a></h1>
<p>The C-PAC benchmark package consists of all of the configuration files and scripts needed to test C-PAC on your machine and compare your outputs with a standard set of outputs processed by the C-PAC team. Specifically, it contains:</p>
<ul class="simple">
<li><p>A shell script to automatically configure the paths within all of the settings files (<code class="docutils literal notranslate"><span class="pre">adjustSettingPaths.sh</span></code>).</p></li>
<li><p>A pipeline configuration file using ANTS (<code class="docutils literal notranslate"><span class="pre">pipeline_config_benchmark.yml</span></code>).</p></li>
<li><p>A data configuration (<code class="docutils literal notranslate"><span class="pre">CPAC_benchmark_participants.yml</span></code>).</p></li>
<li><p>Masks, and ROIs for timeseries extraction, centrality, dual regression, etc.</p></li>
<li><p>A Python script to compare your outputs with ours (<code class="docutils literal notranslate"><span class="pre">correlations_workflow_pipeline.py</span></code>).</p></li>
</ul>
<p>The benchmark package can be downloaded <a class="reference external" href="https://s3.amazonaws.com/fcp-indi/resources/benchmark_package.tar.gz">here</a>.  The following instructions will guide you through the process of running the C-PAC benchmark.</p>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>Before running the benchmark, make sure that your computer has at least 56 GB of RAM.  The benchmark pipeline configuration runs 4 participants at a time with 12 GB allocated for each participant, so 56 GB will give you enough RAM to accommodate these participants plus some extra RAM for any other applications that are running.  If you do not have 56 GB of RAM, you can modify the benchmark pipeline configuration to run fewer participants at a time- just ensure that you have around 14 GB available for each participant.</p>
<p>Also ensure that you have at least 720 GB of free space on the volume you’re running the benchmark on.  This will allow you to keep a working directory (which is chronically emptied as participants are run and should not exceed 55 GB) and two copies of the outputs (one 333 GB copy of our team’s pre-computed outputs, and another 333 GB for the outputs generated by your server or workstation).</p>
</section>
<section id="downloading-the-precomputed-c-pac-outputs-from-the-fcp-indi-s3-bucket">
<h2>Downloading the Precomputed C-PAC Outputs from the FCP-INDI S3 Bucket<a class="headerlink" href="#downloading-the-precomputed-c-pac-outputs-from-the-fcp-indi-s3-bucket" title="Permalink to this headline">¶</a></h2>
<p>The C-PAC precomputed outputs are stored in Amazon Web Service’s Simple Storage Service (S3). They can be accessed using <a class="reference external" href="https://cyberduck.io/">Cyberduck</a>, a file transfer programs for Mac OS X and Windows that handles S3 natively and allow you to navigate through the data using a file browser. For individuals who are more comfortable with the terminal, Cyberduck also has a <a class="reference external" href="https://duck.sh">command line version</a> that works with Windows, Mac OS X, and Linux.  There is also an official <a class="reference external" href="https://aws.amazon.com/cli/">AWS command line tool</a> that can also be used. Instructions for using the grpahical version of Cyberduck are as follows:</p>
<ol class="arabic simple">
<li><p>Open Cyberduck and click on <em>Open Connection</em>.</p></li>
<li><p>Set the application protocol in the dropdown menu to <em>S3 (Amazon Simple Storage Service)</em>.</p></li>
<li><p>Set the server to <em>s3.amazonaws.com</em>.</p></li>
<li><p>Check the box labelled <em>Anonymous Login</em>.</p></li>
<li><p>Expand the More Options tab and set Path to <em>fcp-indi/resources/cpac_benchmark</em>.</p></li>
<li><p>Click <em>Connect</em>.</p></li>
</ol>
<p>The end result should appear similar to the following:</p>
<figure class="align-default">
<img alt="../_images/cyberduck.png" src="../_images/cyberduck.png" />
</figure>
<p>The pre-computed outputs are separated by version number within the directory that will now appear so that you can download the outputs for the version that you are testing out.</p>
</section>
<section id="configuring-c-pac">
<h2>Configuring C-PAC<a class="headerlink" href="#configuring-c-pac" title="Permalink to this headline">¶</a></h2>
<p>First, extract the package using the command <code class="docutils literal notranslate"><span class="pre">tar</span> <span class="pre">xzvf</span> <span class="pre">benchmark_package.tar.gz</span></code>. Then, navigate to <code class="docutils literal notranslate"><span class="pre">benchmark_package/scripts</span></code> in the terminal and execute <code class="docutils literal notranslate"><span class="pre">./adjustSettingPaths.sh</span></code>.  This will ensure that the paths used in the configuration files are in accord with whichever directory you choose to store <code class="docutils literal notranslate"><span class="pre">benchmark_package</span></code> in.  This script assumes that it lives in the <code class="docutils literal notranslate"><span class="pre">/scripts</span></code> directory.  If it has been moved elsewhere, it may be executed using <code class="docutils literal notranslate"><span class="pre">./adjustSettingPaths.sh</span> <span class="pre">&lt;path</span> <span class="pre">to</span> <span class="pre">benchmark_package</span> <span class="pre">directory&gt;</span></code></p>
<p>Next, load in the data configuration.  This contains paths to images that are publicly downloadable from Amazon Webs Services S3.  Open the C-PAC GUI and click <cite>Load</cite> next to the subject pane. Select <code class="docutils literal notranslate"><span class="pre">CPAC_benchmark_participants.yml</span></code>.</p>
<p>Finally, load in the pipeline configuration.  In the main C-PAC window, under <cite>Pipelines</cite>, click <cite>Load</cite> and select the <code class="docutils literal notranslate"><span class="pre">pipeline_config_benchmark.yml</span></code> file located in <code class="docutils literal notranslate"><span class="pre">/settings/configs</span></code> in the benchmark directory. A new pipeline will show up in the list window.  Select this pipeline and click <cite>Edit</cite> to inspect it.</p>
</section>
<section id="running-an-individual-level-analysis">
<h2>Running An Individual-Level Analysis<a class="headerlink" href="#running-an-individual-level-analysis" title="Permalink to this headline">¶</a></h2>
<p>Once you have configured C-PAC by loading in the pipeline configuration YAML and data configuration, you may run the individual-level analysis pipeline by clicking the appropriate button at the bottom of the main C-PAC window. This will bring up a log window that displays the progress of the C-PAC run.</p>
</section>
<section id="comparing-outputs">
<h2>Comparing Outputs<a class="headerlink" href="#comparing-outputs" title="Permalink to this headline">¶</a></h2>
<p>Navigate to the <code class="docutils literal notranslate"><span class="pre">benchmark_packages/scripts</span></code> directory within the benchmark package. Here you will find a script named <code class="docutils literal notranslate"><span class="pre">correlations_workflow_pipeline.py</span></code>, which can help you compare your outputs and the reference outputs from the C-PAC team.</p>
<p>This will produce Pearson’s r and a concordance correlation coefficient between two sets of output for the following measures:</p>
<ul class="simple">
<li><p>ALFF and f/ALFF</p></li>
<li><p>Centrality</p></li>
<li><p>Dual Regression</p></li>
<li><p>ReHo</p></li>
<li><p>VMHC</p></li>
</ul>
<p>To run this script, type <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">correlations_workflow_pipeline.py</span> <span class="pre">&lt;path</span> <span class="pre">to</span> <span class="pre">output1</span> <span class="pre">pipeline&gt;</span> <span class="pre">&lt;path</span> <span class="pre">to</span> <span class="pre">output2</span> <span class="pre">pipeline&gt;</span> <span class="pre">&lt;number</span> <span class="pre">of</span> <span class="pre">cores</span> <span class="pre">to</span> <span class="pre">use&gt;</span> <span class="pre">&lt;descriptive</span> <span class="pre">name&gt;</span></code>.  Make sure that the paths you use point to the <code class="docutils literal notranslate"><span class="pre">pipeline</span></code> directories within the output directories.  To determine the maximum number of cores on your machine, type <code class="docutils literal notranslate"><span class="pre">nproc</span></code> in a terminal window.</p>
<p>When this script is done, it will produce plots for the correlation measures, stored in the directories ‘MNI_outputs’, ‘MNI_SCA’, ‘native_outputs’, ‘natived_SCA’, ‘nonscrub_vs_scrub’, and ‘registration’.  It also produces Python pickle files containing dictionaries with measures as keys and Pearson or concordance correlations as values. Python pickles can be thought of as similar to .mat files in MATLAB- they allow you to save variables in the workspace to an external file on the hard drive.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index">
              <img class="logo" src="../_static/cpac_logo_vertical.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index">Table of Contents</a></h3>
  <ul>
<li class="toctree-l1"><a class="reference internal" href="index">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index">Welcome to CPAC’s developer documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index#indices-and-tables">Indices and tables</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.2.dev Beta documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Benchmark Package</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, C-PAC Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.1.
    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19224662-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-19224662-10');
    </script>
    <script defer src="https://fcp-indi.github.io/scripts/versionList.js"></script>

  </body>
</html>