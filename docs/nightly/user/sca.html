
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18: http://docutils.sourceforge.net/" />

    <title>Seed-based Correlation Analysis (SCA) and Dual Regression &#8212; C-PAC 1.8.2.dev Beta documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex" />
    <link rel="search" title="Search" href="../search" />
    <link rel="next" title="Voxel-Mirrored Homotopic Connectivity (VMHC)" href="vmhc" />
    <link rel="prev" title="Network Centrality" href="centrality" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="vmhc" title="Voxel-Mirrored Homotopic Connectivity (VMHC)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="centrality" title="Network Centrality"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.2.dev Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >Welcome to C-PAC’s user guide!</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="derivatives" accesskey="U">Computable Derivatives</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Seed-based Correlation Analysis (SCA) and Dual Regression</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="seed-based-correlation-analysis-sca-and-dual-regression">
<h1>Seed-based Correlation Analysis (SCA) and Dual Regression<a class="headerlink" href="#seed-based-correlation-analysis-sca-and-dual-regression" title="Permalink to this headline">¶</a></h1>
<section id="connectivity-in-the-brain">
<h2>Connectivity in the Brain<a class="headerlink" href="#connectivity-in-the-brain" title="Permalink to this headline">¶</a></h2>
<p>Brain connectivity can refer to multiple distinct concepts, and it is important to understand the differences between them. When referring to anatomy, connectivity may refer to physical connections between brain areas, such as the long-distance fiber tracts revealed through methods such as Diffusion Tensor Imaging. Another form of connectivity that is commonly discussed in the literature is “functional connectivity”, which is what we will be focusing on here.</p>
</section>
<section id="what-is-functional-connectivity">
<h2>What is Functional Connectivity?<a class="headerlink" href="#what-is-functional-connectivity" title="Permalink to this headline">¶</a></h2>
<p>Perhaps the most confusing thing to understand about functional connectivity is that in most cases, connectivity is never actually measured. This is because the term “functional connectivity” has come to refer to similarities in patterns of brain activity between regions. Two regions are said to be functionally connected if the time series of their activity is highly correlated. The reasoning behind this definition is that brain areas with similar activity patterns are likely to be communicating and sharing information.</p>
</section>
<section id="seed-based-correlation-analysis">
<h2>Seed-based Correlation Analysis<a class="headerlink" href="#seed-based-correlation-analysis" title="Permalink to this headline">¶</a></h2>
<p>Seed-based Correlation Analysis (SCA) is one of the most common ways to explore functional connectivity within the brain. Based on the time series of a seed voxel (or ROI), connectivity is calculated as the correlation of time series for all other voxels in the brain. The result of SCA is a connectivity map showing Z-scores for each voxel indicating how well its time series correlates with the time series of the seed. Below is an example connectivity map showing correlated voxels based on a seed in the precuneus.</p>
<figure class="align-default">
<img alt="../_images/sca_map.png" src="../_images/sca_map.png" />
</figure>
<p>Astute readers will note that the pattern of connectivity mapped above closely resembles the anatomy of the Default Network. Indeed, SCA may be used to explore functional networks that share similar patterns of activity.</p>
</section>
<section id="dual-regression">
<h2>Dual Regression<a class="headerlink" href="#dual-regression" title="Permalink to this headline">¶</a></h2>
<p>Many large-scale functional brain networks have been shown to be reproducible across subjects (Smith et al, 2009; Yeo et al, 2011). Dual Regression (Beckman et al, 2009; Filippini et al, 2009) allows researchers to investigate individual and group differences in the structure of these networks, as well as to identify subject-specific networks based on networks identified at the group level.</p>
<p>The following steps are performed for each spatial map provided for Dual Regression:</p>
<ol class="arabic simple">
<li><p><strong>Spatial Regression:</strong> The spatial map is used as a spatial regressor in a GLM to find the time series associated with the voxels in that map.</p></li>
<li><p><strong>Temporal Regression:</strong> The time series found by spatial regression is then used as a temporal regressor to find the full set of voxels associated with that time series.</p></li>
</ol>
<p>The result of these steps is a subject-specific spatial map based on the original spatial map.</p>
<p>The spatial maps used during Dual Regression can be generated any number of ways, but a common practice is to use Independent Component Analysis (Smith et al, 2009) or clustering algorithms (Yeo et al, 2011) to generate group-specific maps of large-scale brain networks.</p>
</section>
<section id="configuring-c-pac">
<h2>Configuring C-PAC<a class="headerlink" href="#configuring-c-pac" title="Permalink to this headline">¶</a></h2>
<p>Before SCA can be calculated, you <strong>must</strong> first extract a seed time series from which to calculate correlations. This is done by configuring and running <a class="reference internal" href="tse"><span class="doc">Time Series Extraction</span></a>.  <strong>You will not be able to proceed in the GUI without first entering in an ROI Specification, and will receive an error if the specification is not defined.</strong></p>
<figure class="align-default">
<img alt="../_images/sca_gui.png" src="../_images/sca_gui.png" />
</figure>
<ol class="arabic simple">
<li><p><strong>Seed-based Correlation (SCA) - [On, Off]:</strong>  For each extracted ROI Average and/or ROI Voxelwise time series, CPAC will generate a whole-brain correlation map. It should be noted that for a given seed/ROI, SCA maps for ROI Average and ROI Voxelwise time series will be the same.</p></li>
<li><dl class="simple">
<dt><strong>SCA ROI Paths - [path dialogue]:</strong> Clicking on the <em>+</em> icon to the right of the box here will bring up a dialog where you can define multiple paths to NifTIs containing ROI masks.  You may add multiple ROIs to the box.  Three columns within the box can be checked on and off to enable specific options for SCA/Dual Regression:</dt><dd><ul class="simple">
<li><p>Avg - Run seed-based correlation analysis using the average time series of each ROI.</p></li>
<li><p>DualReg - Run dual regression for each ROI.</p></li>
<li><p>MultiReg - Run a multiple regression SCA where C-PAC will enter all extracted time series from ROI Average TSE, ROI Voxelwise TSE, and Spatial Regression into a single multiple regression model and output a single correlation map.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><strong>Normalize Time Series (Dual Regression) - [On, Off]:</strong>  Normalize each time series before running Dual Regression.</p></li>
</ol>
<section id="configuration-without-the-gui">
<h3>Configuration Without the GUI<a class="headerlink" href="#configuration-without-the-gui" title="Permalink to this headline">¶</a></h3>
<p>The following nested key/value pairs will be set to these defaults if not defined in your <a class="reference internal" href="pipelines/pipeline_config"><span class="doc">pipeline configuration YAML</span></a>.</p>
<p>Unlike most lines in a C-PAC pipeline configuration file, the keys under <code class="docutils literal notranslate"><span class="pre">*_roi_paths</span></code> are user-definable.</p>
<p>If you exclude <code class="docutils literal notranslate"><span class="pre">*_roi_paths</span></code> from your pipeline configuration, the default atlases and analyses will be used.</p>
<p>If you include <code class="docutils literal notranslate"><span class="pre">*_roi_paths</span></code>, <strong>only the atlases and analyses provided</strong> will be used, unless you add the optional key/value pair <code class="docutils literal notranslate"><span class="pre">roi_paths_fully_specified:</span> <span class="pre">False</span></code> in the relevant section, in which case the default atlases and analyses will be updated with the atlases and analyses specified in your pipeline config. For example,</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">timeseries_extraction</span><span class="p">:</span>
    <span class="nt">roi_paths_fully_specified</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>

<span class="nt">seed_based_correlation_analysis</span><span class="p">:</span>
    <span class="nt">roi_paths_fully_specified</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
</pre></div>
</div>
<p>would keep any default atlases not respecified in your pipeline configuration.</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">seed_based_correlation_analysis</span><span class="p">:</span>

  <span class="c1"># SCA - Seed-Based Correlation Analysis</span>
  <span class="c1"># For each extracted ROI Average time series, CPAC will generate a whole-brain correlation map.</span>
  <span class="c1"># It should be noted that for a given seed/ROI, SCA maps for ROI Average time series will be the same.</span>
  <span class="nt">run</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Off</span>

  <span class="c1"># Enter paths to region-of-interest (ROI) NIFTI files (.nii or .nii.gz) to be used for seed-based correlation analysis, and then select which types of analyses to run.</span>
  <span class="c1"># Denote which analyses to run for each ROI path by listing the names below. For example, if you wish to run Avg and MultReg, you would enter: &#39;/path/to/ROI.nii.gz&#39;: Avg, MultReg</span>
  <span class="c1"># available analyses:</span>
  <span class="c1">#   /path/to/atlas.nii.gz: Avg, DualReg, MultReg</span>
  <span class="nt">sca_roi_paths</span><span class="p">:</span>
    <span class="nt">/cpac_templates/PNAS_Smith09_rsn10.nii.gz</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DualReg</span>
    <span class="nt">/cpac_templates/CC400.nii.gz</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Avg, MultReg</span>
    <span class="nt">/cpac_templates/ez_mask_pad.nii.gz</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Avg, MultReg</span>
    <span class="nt">/cpac_templates/aal_mask_pad.nii.gz</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Avg, MultReg</span>
    <span class="nt">/cpac_templates/CC200.nii.gz</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Avg, MultReg</span>
    <span class="nt">/cpac_templates/tt_mask_pad.nii.gz</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Avg, MultReg</span>
    <span class="nt">/cpac_templates/ho_mask_pad.nii.gz</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Avg, MultReg</span>
    <span class="nt">/cpac_templates/rois_3mm.nii.gz</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Avg, MultReg</span>

  <span class="c1"># Normalize each time series before running Dual Regression SCA.</span>
  <span class="nt">norm_timeseries_for_DR</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>C.F. Beckmann, C.E. Mackay, N. Filippini, and S.M. Smith. <a class="reference external" href="http://fsl.fmrib.ox.ac.uk/fsl/fslwiki/DualRegression?action=AttachFile&amp;do=get&amp;target=CB09.pdf">Group comparison of resting-state FMRI data using multi-subject ICA and dual regression</a>. OHBM, 2009.</p>
<ol class="upperalpha simple" start="14">
<li><p>Filippini, B.J. MacIntosh, M.G. Hough, G.M. Goodwin, G.B. Frisoni, S.M. Smith, P.M. Matthews, C.F. Beckmann and C.E. Mackay. <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/19357304">Distinct patterns of brain activity in young carriers of the APOE-ε4 allele</a>. PNAS, 106(17):7209-14, 2009.</p></li>
</ol>
<p>Smith, S. M., Fox, P. T., Miller, K. L., Glahn, D. C., Fox, P. M., Mackay, C. E., et al. (2009). Correspondence of the brain’s functional architecture during activation and rest. Proceedings of the National Academy of Sciences of the United States of America, 106(31), 13040–13045. doi:10.1073/pnas.0905267106</p>
<p>Thomas Yeo, B. T., Krienen, F. M., Sepulcre, J., Sabuncu, M. R., Lashkari, D., Hollinshead, M., et al. (2011). The organization of the human cerebral cortex estimated by intrinsic functional connectivity. Journal of Neurophysiology, 106(3), 1125–1165. doi:10.1152/jn.00338.2011</p>
</section>
<section id="external-resources">
<h2>External Resources<a class="headerlink" href="#external-resources" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://mindhive.mit.edu/node/58">mindhive - ConnectivityFAQ</a></p></li>
<li><p><a class="reference external" href="http://www.scholarpedia.org/article/Brain_connectivity">Brain Connectivity - Scholarpedia</a></p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index">
              <img class="logo" src="../_static/cpac_logo_vertical.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index">Table of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index#the-c-pac-mission">The C-PAC Mission</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#latest-release-version-1-8-1-beta-sep-17-2021">Latest Release: Version 1.8.1 Beta (Sep 17, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#the-c-pac-team">The C-PAC Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="index#funding-acknowledgements">Funding Acknowledgements</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index#user-guide-index">User Guide Index</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="quick">1. C-PAC Quickstart</a></li>
<li class="toctree-l3"><a class="reference internal" href="subject_list_config">2. Specify Your Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipelines/pipeline_config">3. Select Your Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="preprocessing">4. Pre-Process Your Data</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="derivatives">5. Compute Derivatives</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="alff">ALFF and f/ALFF</a></li>
<li class="toctree-l4"><a class="reference internal" href="reho">ReHo</a></li>
<li class="toctree-l4"><a class="reference internal" href="centrality">Network Centrality</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">SCA/Dual Regression</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#connectivity-in-the-brain">Connectivity in the Brain</a></li>
<li class="toctree-l5"><a class="reference internal" href="#what-is-functional-connectivity">What is Functional Connectivity?</a></li>
<li class="toctree-l5"><a class="reference internal" href="#seed-based-correlation-analysis">Seed-based Correlation Analysis</a></li>
<li class="toctree-l5"><a class="reference internal" href="#dual-regression">Dual Regression</a></li>
<li class="toctree-l5"><a class="reference internal" href="#configuring-c-pac">Configuring C-PAC</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#configuration-without-the-gui">Configuration Without the GUI</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l5"><a class="reference internal" href="#external-resources">External Resources</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="vmhc">VMHC</a></li>
<li class="toctree-l4"><a class="reference internal" href="pypeer">PyPEER Integration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="running">6. All Run Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="group_analysis">7. Run Group Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="output_dir">8. Check Your Outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="help">9. Troubleshoot</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnotes">10. Release Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="appendix">Appendix</a></li>
<li class="toctree-l3"><a class="reference internal" href="appendix#benchmark-package">Benchmark Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index">Welcome to CPAC’s developer documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index#indices-and-tables">Indices and tables</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="vmhc" title="Voxel-Mirrored Homotopic Connectivity (VMHC)"
             >next</a> |</li>
        <li class="right" >
          <a href="centrality" title="Network Centrality"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.8.2.dev Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >Welcome to C-PAC’s user guide!</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="derivatives" >Computable Derivatives</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Seed-based Correlation Analysis (SCA) and Dual Regression</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, C-PAC Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.0.
    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19224662-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-19224662-10');
    </script>
    <script defer src="https://fcp-indi.github.io/scripts/versionList.js"></script>

  </body>
</html>